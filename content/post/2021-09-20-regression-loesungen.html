---
title: Regression - Lösungen
author: 
date: '2021-01-04'
slug: regression-loesungen
categories:
  - BSc2
  - Loesungen
tags:
  - Regression
subtitle: ''
summary: ''
authors: [winkler, neubauer]
lastmod: '2021-01-04T13:34:32+01:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
expiryDate: '2022-09-15'
publishDate: '2022-01-28'
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="vorbereitung" class="section level2">
<h2>Vorbereitung</h2>
<p>Laden Sie die Daten aus <a href="/post/fb20.rda"><i class="fas fa-download"></i> <code>fb20.rda</code></a>.</p>
<pre class="r"><code>setwd(...) #auf eigenen Pfad</code></pre>
<pre class="r"><code>load(&quot;fb20.rda&quot;)</code></pre>
<hr />
</div>
<div id="regression" class="section level1">
<h1>Regression</h1>
<div id="aufgabe-1" class="section level2">
<h2>Aufgabe 1</h2>
<p>Welche der fünf Persönlichkeitsdimensionen Extraversion (<code>extra</code>), Verträglichkeit (<code>vertr</code>), Gewissenhaftigkeit (<code>gewis</code>), Neurotizsimus (<code>neuro</code>) und Intellekt (<code>intel</code>) zeigt den höchsten linearen Zusammenhang mit der Lebenszufriedenheit (<code>lz</code>)?</p>
<ul>
<li>Erstellen Sie für jeden Zusammenhang je ein Streudiagramm.
<strong><code>extra</code>:</strong></li>
</ul>
<pre class="r"><code>plot(fb20$extra, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><strong><code>vertr</code>:</strong></p>
<pre class="r"><code>plot(fb20$vertr, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><strong><code>gewis</code>:</strong></p>
<pre class="r"><code>plot(fb20$gewis, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><strong><code>neuro</code>:</strong></p>
<pre class="r"><code>plot(fb20$neuro, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><strong><code>intel</code>:</strong></p>
<pre class="r"><code>plot(fb20$intel, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<ul>
<li>Schätzen Sie für jeden Zusammenhang je ein Modell.
<strong><code>extra</code>:</strong></li>
</ul>
<pre class="r"><code>fme &lt;- lm(lz ~ extra, fb20)
lm(formula = lz ~ 1 + extra, data = fb20)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ 1 + extra, data = fb20)
## 
## Coefficients:
## (Intercept)        extra  
##      3.8119       0.3538</code></pre>
<pre class="r"><code>coef(fme) </code></pre>
<pre><code>## (Intercept)       extra 
##    3.811938    0.353777</code></pre>
<pre class="r"><code>summary(fme)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ extra, data = fb20)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9155 -0.5954  0.1267  0.7498  2.0152 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.8119     0.5835   6.533 3.28e-09 ***
## extra         0.3538     0.1654   2.139    0.035 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.126 on 94 degrees of freedom
##   (2 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.04641,    Adjusted R-squared:  0.03626 
## F-statistic: 4.575 on 1 and 94 DF,  p-value: 0.03504</code></pre>
<pre class="r"><code>formula(fme)</code></pre>
<pre><code>## lz ~ extra</code></pre>
<p><strong><code>vertr</code>:</strong></p>
<pre class="r"><code>fmv &lt;- lm(lz ~ vertr, fb20)
lm(formula = lz ~ 1 + vertr, data = fb20) </code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ 1 + vertr, data = fb20)
## 
## Coefficients:
## (Intercept)        vertr  
##     5.38964     -0.08204</code></pre>
<pre class="r"><code>coef(fmv) </code></pre>
<pre><code>## (Intercept)       vertr 
##  5.38963502 -0.08203851</code></pre>
<pre class="r"><code>summary(fmv)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ vertr, data = fb20)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.6000 -0.7846  0.1693  0.8449  2.0206 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.38964    0.96132   5.607 2.06e-07 ***
## vertr       -0.08204    0.22097  -0.371    0.711    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.152 on 94 degrees of freedom
##   (2 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.001464,   Adjusted R-squared:  -0.009159 
## F-statistic: 0.1378 on 1 and 94 DF,  p-value: 0.7113</code></pre>
<pre class="r"><code>formula(fmv)</code></pre>
<pre><code>## lz ~ vertr</code></pre>
<p><strong><code>gewis</code>:</strong></p>
<pre class="r"><code>fmg &lt;- lm(lz ~ gewis, fb20)
lm(formula = lz ~ 1 + gewis, data = fb20) #Koeffizienten anzeigen, alternativ mit coef</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ 1 + gewis, data = fb20)
## 
## Coefficients:
## (Intercept)        gewis  
##      2.9038       0.5204</code></pre>
<pre class="r"><code>coef(fmg) </code></pre>
<pre><code>## (Intercept)       gewis 
##   2.9037996   0.5203693</code></pre>
<pre class="r"><code>summary(fmg)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ gewis, data = fb20)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8455 -0.7256  0.2147  0.7696  2.1351 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.9038     0.7623   3.809 0.000249 ***
## gewis         0.5204     0.1840   2.827 0.005733 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.107 on 94 degrees of freedom
##   (2 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.07838,    Adjusted R-squared:  0.06858 
## F-statistic: 7.995 on 1 and 94 DF,  p-value: 0.005733</code></pre>
<pre class="r"><code>formula(fmg)</code></pre>
<pre><code>## lz ~ gewis</code></pre>
<p><strong><code>neuro</code>:</strong></p>
<pre class="r"><code>fmn &lt;- lm(lz ~ neuro, fb20)
lm(formula = lz ~ 1 + neuro, data = fb20) </code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ 1 + neuro, data = fb20)
## 
## Coefficients:
## (Intercept)        neuro  
##      6.3692      -0.3848</code></pre>
<pre class="r"><code>coef(fmn) </code></pre>
<pre><code>## (Intercept)       neuro 
##   6.3692259  -0.3848105</code></pre>
<pre class="r"><code>summary(fmn)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ neuro, data = fb20)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1996 -0.8464  0.1700  0.8055  1.8738 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   6.3692     0.5298  12.021   &lt;2e-16 ***
## neuro        -0.3848     0.1493  -2.577   0.0115 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.114 on 94 degrees of freedom
##   (2 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.06601,    Adjusted R-squared:  0.05607 
## F-statistic: 6.643 on 1 and 94 DF,  p-value: 0.01151</code></pre>
<pre class="r"><code>formula(fmn)</code></pre>
<pre><code>## lz ~ neuro</code></pre>
<p><strong><code>intel</code>:</strong></p>
<pre class="r"><code>fmi &lt;- lm(lz ~ intel, fb20)
lm(formula = lz ~ 1 + intel, data = fb20) </code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ 1 + intel, data = fb20)
## 
## Coefficients:
## (Intercept)        intel  
##       3.893        0.307</code></pre>
<pre class="r"><code>coef(fmi) </code></pre>
<pre><code>## (Intercept)       intel 
##   3.8930403   0.3069787</code></pre>
<pre class="r"><code>summary(fmi)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ intel, data = fb20)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9512 -0.8675  0.2709  0.8099  2.3395 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.8930     0.7317   5.320    7e-07 ***
## intel         0.3070     0.1941   1.581    0.117    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.138 on 94 degrees of freedom
##   (2 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.02591,    Adjusted R-squared:  0.01555 
## F-statistic:   2.5 on 1 and 94 DF,  p-value: 0.1172</code></pre>
<pre class="r"><code>formula(fmi)</code></pre>
<pre><code>## lz ~ intel</code></pre>
<p>Wenn wir die Koeffizienten der Modelle vergleichen, sehen wir, dass <code>gewis</code> den größten linearen Zusammenhang mit <code>lz</code> aufweist</p>
<ul>
<li>Prüfen Sie die Voraussetzungen und interpretieren Sie den standardisierten Koeffizienten des linearen Zusammenhangs zwischen Gewissenhaftigkeit und Lebenszufriedenheit. Wie verändert sich <code>lz</code>, wenn sich <code>gewis</code> um eine Standardabweichung erhöht?</li>
</ul>
<div id="voraussetzungen" class="section level3">
<h3>Voraussetzungen:</h3>
<ol style="list-style-type: decimal">
<li>Linearität: Zusammenhang muss linear sein <span class="math inline">\(\rightarrow\)</span> Grafische Überprüfung (Scatterplot)<br />
</li>
<li>Varianzhomogenität (Homoskedastizität) der Fehler: der Fehler jedes Wertes der UV hat annährend die gleiche Varianz<br />
</li>
<li>Normalverteilung der Fehlervariablen<br />
</li>
<li>Unabhängigkeit der Fehler</li>
</ol>
<p>Die Voraussetzungen 2-4 können erst geprüft werden, nachdem das Modell schon gerechnet wurde, weil sie sich auf die Fehler (Residuen: Differenz aus beobachtetem und vorhergesagtem Wert für y) beziehen!</p>
<p><strong>zu 1. Linearität: Zusammenhang muss linear sein <span class="math inline">\(\rightarrow\)</span> Grafische Überprüfung (Scatterplot)</strong></p>
<pre class="r"><code>plot(fb20$gewis, fb20$lz, xlab = &quot;Gewissenhaftigkeit&quot;, ylab = &quot;Lebenszufriedenheit&quot;, 
     main = &quot;Zusammenhang zwischen Gewissenhaftigkeit und Lebenszufriedenheit&quot;, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
lines(loess.smooth(fb20$gewis, fb20$lz), col = &#39;blue&#39;)    #beobachteter, lokaler Zusammenhang
fmg &lt;- lm(lz ~ gewis, fb20)                              #Modell erstellen und ablegen
abline(fmg, col = &quot;red&quot;)                                  #Modellierter linearer Zusammenhang in zuvor erstellten Plot einzeichnen</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><strong>zu Voraussetzungen 2-4:</strong></p>
<pre class="r"><code>par(mfrow = c(2, 2)) #Vier Abbildungen gleichzeitig
plot(fmg)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1)) #wieder auf eine Abbildung zurücksetzen</code></pre>
<p>In diesem Fall ist alles weitestgehend erfüllt.</p>
<pre class="r"><code>sfmg &lt;- lm(scale(lz) ~ scale(gewis), fb20)
sfmg</code></pre>
<pre><code>## 
## Call:
## lm(formula = scale(lz) ~ scale(gewis), data = fb20)
## 
## Coefficients:
##  (Intercept)  scale(gewis)  
##    -0.007837      0.293899</code></pre>
<p>Wenn sich die Variable <code>gewis</code> um eine Standardabweichung verändert, verändert sich das Kriterium <code>lz</code> um 0,294 Standardabweichungen.</p>
</div>
</div>
<div id="aufgabe-2" class="section level2">
<h2>Aufgabe 2</h2>
<p>Ein paar Studierende wurden nachträglich zum Studiengang Psychologie zugelassen und befinden sich daher nicht im Datensatz. Die neuen Studenten wurden nachträglich befragt und weisen auf der Skala Neurotizismus folgende Werte auf: 1.25; 2.75; 3.5; 4.25; 3.75; 2.15.</p>
<ul>
<li>Machen Sie eine Vorhersage für die Lebenszufriedenheit für die neuen Studenten.</li>
</ul>
<pre class="r"><code>new &lt;- data.frame(neuro = c(1.25, 2.75, 3.5, 4.25, 3.75, 2.15))
predict(fmn, newdata = new)</code></pre>
<pre><code>##        1        2        3        4        5        6 
## 5.888213 5.310997 5.022389 4.733781 4.926187 5.541883</code></pre>
<ul>
<li>Erstellen Sie ein Streu-Punkt-Diagramm mit Regressionsgerade für den linearen Zusammenhang zwischen Neurotizismus und Lebenszufriedenheit.</li>
</ul>
<pre class="r"><code>plot(fb20$neuro, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
abline(fmn, col = &quot;red&quot;)</code></pre>
<p><img src="/post/2021-09-20-regression-loesungen_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<ul>
<li>Wie viel Prozent der Varianz werden durch das Modell erklärt?</li>
</ul>
<pre class="r"><code>summary(fmn)</code></pre>
<pre><code>## 
## Call:
## lm(formula = lz ~ neuro, data = fb20)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1996 -0.8464  0.1700  0.8055  1.8738 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   6.3692     0.5298  12.021   &lt;2e-16 ***
## neuro        -0.3848     0.1493  -2.577   0.0115 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.114 on 94 degrees of freedom
##   (2 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.06601,    Adjusted R-squared:  0.05607 
## F-statistic: 6.643 on 1 and 94 DF,  p-value: 0.01151</code></pre>
<p>R² = 0.066 –&gt; 6,6% der Varianz von <code>lz</code> werden durch das Modell erklärt. Determinationskoeffizient <span class="math inline">\(R^2\)</span> ist signifikant.</p>
<hr />
</div>
</div>
