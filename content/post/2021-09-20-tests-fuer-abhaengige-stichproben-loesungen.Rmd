---
title: Tests für abhängige Stichproben - Lösungen
date: '2020-12-17'
slug: gruppenvergleiche-abhaengig-loesungen
categories:
  - BSc2
tags:
  - t-Test
subtitle: ''
summary: ''
authors: [koehler, buchholz]
lastmod: '2020-12-17T13:15:14+01:00'
featured: no
header:
  image: "/header/BSc2_test_abh_stpr.jpg"
  caption: "[Courtesy of pxhere](https://pxhere.com/en/photo/449195)"
projects: []
expiryDate: '2022-09-15'
publishDate: '2022-01-29'
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(error = TRUE)
library(psych)
library(car)
library(effsize)
```


## Aufgabe 1
Ein Therapeut behauptet, dass eine von ihm entwickelte Meditation die Zufriedenheit von Menschen positiv beeinflusst. Er möchte dies mit wissenschaftlichen Methoden zeigen und misst die Zufriedenheit vor und nach der Meditation (Daten mit Intervallskalenqualität). Es ergeben sich folgende Werte für 18 Personen:   

```{r echo = FALSE, results='asis'}
library(knitr)
kable(data.frame(Vpn = 1:18, Vorher = c(4,6,3,7,2,8,3,5,6,4,5,4,3,7,7,6,4,7), Nachher = c(6,7,8,7,4,7,6,6,8,5,9,6,6,7,6,4,5,8)))
```

Wirkt die Meditation auf die Zufriedenheit?

<details><summary>Lösung</summary>
**Datensatz generieren**
```{r}
dataMeditation <- data.frame(Vpn = 1:18, Vorher = c(4,6,3,7,2,8,3,5,6,4,5,4,3,7,7,6,4,7), Nachher = c(6,7,8,7,4,7,6,6,8,5,9,6,6,7,6,4,5,8))
```

**Deskriptivstatistische Beantwortung der Fragestellung: grafisch**

Histogramme (weil Intervallskalenqualität):
Je ein Histogramm pro Gruppe, untereinander dargestellt, vertikale Linie für den jeweiligen Mittelwert
```{r}
par(mfrow=c(2,1), mar=c(3,2,2,0))
hist(dataMeditation[, "Vorher"], xlim=c(0,10), ylim=c(1,6), main="Zufriedenheit vor der Meditation", xlab="", ylab="", las=1)
abline(v=mean(dataMeditation[, "Vorher"]), lty=2, lwd=2)
hist(dataMeditation[, "Nachher"], xlim=c(0,10), ylim=c(1,6), main="Zufriedenheit nach der Meditation", xlab="", ylab="", las=1)
abline(v=mean(dataMeditation[, "Nachher"]), lty=2, lwd=2)
par(mfrow=c(1,1))
```

**Deskriptivstatistische Beantwortung der Fragestellung: statistisch**
```{r}
summary(dataMeditation[, "Vorher"])
summary(dataMeditation[, "Nachher"])
#alternativ
library(psych)
describe(dataMeditation[, "Vorher"])
describe(dataMeditation[, "Nachher"])
```
Mittelwert vorher (_M_ = 5.1, _SD_ = 1.76) ist deskriptiv niedriger als Mittelwert nachher (_M_ = 6.4, _SD_ = 1.38).

**Voraussetzungen für t-Test für abhängige Stichproben**

1. Die abhängige Variable ist intervallskaliert $\rightarrow$ ok
2. Die Messwerte innerhalb der Paare dürfen sich gegenseitig beeinflussen/voneinander abhängig sein; keine Abhängigkeiten zwischen den Messwertpaaren $\rightarrow$ ok
3. Die Differenzvariable _d_ muss in der Population normalverteilt sein $\rightarrow$ ab _n_ => 30 gegeben, ansonsten grafische Prüfung oder Hintergrundwissen 

**Voraussetzungsprüfung: Normalverteilung von _d_**
```{r}
par(mar=c(3,3,3,0)) #aendern der Raender (margins) des Plot-Fensters
difference <- dataMeditation[, "Vorher"]-dataMeditation[, "Nachher"]
hist(difference, xlim=c(-6,4), main="Verteilung der Differenzen", xlab="Differenzen", ylab="", las=1,freq=F)
curve(dnorm(x, mean=mean(difference), sd=sd(difference)), col="blue", lwd=2, add=T)
par(mfrow=c(1,1)) #Zuruecksetzens auf default
qqnorm(difference,las=1)
qqline(difference, col="blue")
```

$\Rightarrow$ Differenzen sehen einigermaßen normalverteilt aus

**Hypothesen**

* Art des Effekts: Unterschiedshypothese  
* Richtung des Effekts: Gerichtet $\rightarrow$ gerichtete Hypothesen (Der Wissenschaftler erwartet eine positive Wirkung
#    der Meditation auf die Zufriedenheit.) 
* Größe des Effekts: Unspezifisch  


Hyothesenpaar (inhaltlich):  
H0: Die Meditation wirkt sich nicht oder negativ auf die Zufriedenheit aus.
H1: Die Meditation wirkt sich positiv auf die Zufriedenheit aus.

Hypthesenpaar (statistisch):  

* $H_0$: $\eta_\text{vorher} \ge \eta_\text{nachher}$  bzw. $\mu_{d} \ge 0$
* $H_1$: $\eta_\text{vorher} <   \eta_\text{nachher}$  bzw. $\mu_{d} < 0$

**Spezifikation des Signifikanzniveaus**

$\alpha = .05$

**Durchführung des _t_-Tests für abhängige Stichproben in R**

```{r}
t.test(x = dataMeditation[, "Vorher"], y  = dataMeditation[, "Nachher"], # die beiden abhaengigen Gruppen
       paired = T,                       # Stichproben sind abhaengig
       alternative = "less",             # gerichtete Hypothese -> einseitige Testung
       conf.level = .95)                 # alpha = .05
```

* Zur Erinnerung: _df_ bei _t_-test mit abhängigen Stichproben: _n_ - 1 (wobei _n_ die Anzahl der Paare darstellt)
* _t_(0.05;17) = -3.174, _p_ < .05 $\rightarrow$ signifikant, H0 wird verworfen, H1 wird angenommen.

**Schätzung des standardisierten Populationseffekts**

```{r}
mean_d <- mean(difference)
sd.d.est <- sd(difference) #die geschaetzte SD der Differenzen
d_Meditation <- mean_d/sd.d.est
d_Meditation
```

$\Rightarrow$ Der standardisierte Populationseffekt beträgt _d2''_ = -0.75 und ist laut Konventionen nach Cohen (1988) groß. 

**Formales Berichten des Ergebnisses**

Es wurde in einer Wiederholungsmessung untersucht, ob sich Meditation auf Zufriedenheit auswirkt. Zunächst findet sich deskriptiv ein Unterschied: Vor der Meditation liegt der durchschnittliche Zufriedenheitswert bei 5.06 (_SD_ = 1.76), während er nach der Meditation bei 6.39 (_SD_ = 1.38) liegt. 

Zur Beantwortung der Fragestellung wurde ein gerichteter _t_-Test für abhängige Stichproben durchgeführt. Der Gruppenunterschied ist signifikant (_t_(17) = -3.17, _p_ < .05), somit wird die Nullhypothese verworfen und die Alternativhypothese angenommen. Die Meditation hat einen Einfluss auf die Zufriedenheit.

Dieser Einfluss ist nach dem standardisierte Populationseffekt von _d''_ = 0.75 groß.


</details>
