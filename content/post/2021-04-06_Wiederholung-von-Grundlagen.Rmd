---
title: "Wiederholung von Grundlagen in R"
date: '2021-03-30'
slug: wiederholung-grundlagen
categories:
  - BSc7
tags:
  - Grundlagen
  - Wiederholung
  - Einführung
subtitle: ''
summary: ''
authors: [nehler, schueller, schultze]
lastmod: '2021-04-06 12:00:12 CEST'
featured: no
header:
 image: "/header/PsyBSc7_Wdh.jpg"
 caption: "[Courtesy of pxhere](https://pxhere.com/en/photo/846937)"
projects: []
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align = "center")
```

## Wiederholung von Grundlagen in R

Die Praktikum des Moduls PsyBSc 7 baut auf Grundlagen in `R` auf, die Sie im Modul PsyBSc2 erlernt haben. Wir wollen für einen sanften Einstieg zum Start des Semesters nochmal einige Inhalte wiederholen. Wenn Sie eigenständig eine umfassendere Auffrischung der Inhalte des letzten Semesters benötigen oder sich gerne auf die Datenanalyse in R einstimmen möchten, können Sie jederzeit über Pandar auf die Inhalte von [PsyBSc 2](/lehre/#bsc2) zurückgreifen. 

Dieses Tutorial beschäftigt sich zunächst nochmal mit der Installation von `R` und einigen allgemeinen Arbeitshinweisen. Anschließend gehen wir die Grundfunktionen durch und betrachten ausgewählte Datenanalysen aus dem letzten Semester. Für interessierte Lesende gibt es im Anhang einführende Informationen dazu, wie man in `R` neben der Durchführung Datenanalyse auch gleich ein Dokument erstellen kann.

***

### Installation 

Für den Verlauf dieses Modul benötigen Sie die Statistiksoftware `R` und für eine bessere Bedienbarkeit die Benutzeroberfläche `RStudio` auf Ihrem Rechner. Sie haben beide Programme natürlich schon im Modul PsyBSc2 heruntergeladen. Falls Sie aber ein neues Gerät verwenden oder die Programme schon gelöscht haben, können Sie auf den folgenden Seiten einen kostenlosen Download durchführen.

**Downloadlinks:**

`R` für das Windows-Betriebssystem: [Download von CRAN](https://cran.r-project.org/bin/windows/base/)

`R` für das Mac-Betriebssystem: [Download von CRAN](https://cran.r-project.org/bin/macosx/)

`RStudio`: [Download von der `RStudio` Seite](https://rstudio.com/products/rstudio/download/) (Herunterscrollen um Version für Windows oder Mac zu wählen) 

Hier finden Sie außerdem eine ausführliche [Anleitung](https://www.uni-kiel.de/medinfo/lehre/medlife/Installation_instructions_for_R_and_RStudio.pdf) zum Herunterladen und Installieren von `R` und `RStudio`.

***

## Allgemeine Arbeitshinweise

Wir können Ihnen im Studium nur so viel beibringen, wie es unsere und Ihre Zeit zulässt. Diese Zeit schwankt von Person zu Person, wir können aber in jedem Fall mit Sicherheit behaupten, dass es nicht genug ist, um Sie auf alle Probleme vorzubereiten, denen Sie im Laufe ihrer akademischen Karriere begegnen werden. Daher ist unser Ziel nicht nur, Ihnen alle für diesen Kurs relevanten Kompetenzen beizubringen, sondern Sie darüber hinaus zu *kompetenten Problemlöser:innen* in Statistik - unter Verwendung von `R` - zu machen. Nachfolgend wollen wir Ihnen daher einige Tipps & Ressourcen an die Hand geben, die wir Ihnen beim Erlernen, Vertiefen und Problemlösen empfehlen können.

### Ressourcen

**R ist eine Open-Source-Software.** 
Dies bedeutet auch, dass es online eine Vielzahl von Ressourcen gibt, die Sie beim Lernen nutzen können und sollen. Zum Einen gibt es online sehr viele kostenlose Informationsangebote (z.B. die [Introduction to R vom R Core Team](https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf), das [R-Cookbook](http://www.cookbook-r.com), das Buch [R for Data Science](https://r4ds.had.co.nz), oder hier eine [Einführung in R für Psychologie-Studierende](https://r-intro.tadaa-data.de/book/was-ist-r.html), sowie teilweise kostenlosen Übungsplattformen (z.B. [Datacamp](https://www.datacamp.com), [Codecademy](https://www.codecademy.com etc.)).
Dazu kommen die sehr aktiven Foren bzw. Communities, wie vorallem [Stack Overflow](https://stackoverflow.com) für R-Programmierung und [Cross Validated](https://stats.stackexchange.com) für allgemeine Statistikfragen. Lernen Sie, diese Ressourcen für sich zu nutzen!

**Fehlermeldungen sind unsere Freunde** 

Bei der Arbeit mit `R` sind Fehlermeldungen auch für langjährige Anwender:innen Alltag (wirklich!). Sie sollten also eine Frustrationstoleranz aufbauen und nicht erwarten, eine Aufgabe ohne Fehlermeldungen lösen zu können - das ist unrealistisch!
> Vielmehr sollten Sie lernen, Fehlermeldungen *zu verstehen* und daraus zu lernen. Versuchen Sie nachzuvollziehen, auf welches Element in Ihrem Code sich eine Fehlermeldung bezieht und was der Inhalt besagt. 

Indem Sie Codeelemente separat ausführen, können Sie probieren, eine Fehlerquelle zu isolieren. Oder brechen Sie den Code auf eine einfache Einheit herunter, welche ohne Fehler funktioniert, und fügen Sie nacheinander Elemente hinzu. Testen Sie auch, ob alle Objekte (Datensätze, Vektoren, etc.), die Sie verwenden, das gewünschte Format haben, richtig eingelesen wurden, den richtigen Inhalt haben, versehentlich überschrieben wurden, etc.  Wenn Sie nicht weiterkommen, versuchen Sie den Text der Fehlermeldung im Internet zu suchen, denn häufig finden Sie Antworten auf Ihre Fragen in den oben genannten Online-Foren!

**Hilfe zur Selbsthilfe**

Lernen Sie, mit der `R`-internen Hilfefunktion zu arbeiten. Jede Funktion in `R` hat eine Hilfeseite, auf der die Anwendung dieser Funktion erklärt wird. Die Struktur ist immer ähnlich: Nach einer Beschreibung der Funktion folgen die *Argumente*, also Informationen, die Sie in die Funktion hineingeben können/müssen. Unter *Values* wird der Output aus einer Funktion beschrieben. Diese Informationen helfen Ihnen, die Ergebnisse zu interpretieren. Weiter unten werden meist Beispiele der Verwendung aufgezeigt. Auch wenn es zum Anfang noch schwer ist, versuchen Sie, die Informationen auf diesen Seiten zu verstehen. Irgendwann wird es leichter, versprochen!

Oft gibt es darüber hinaus online noch ausführlichere Informationen zur Anwendung. Beispielsweise gibt es [hier](https://personality-project.org/r/psych/vignettes/intro.pdf) eine ausführliche Anleitung zum `Psych`-Package, oder auch so genannte Cheatsheets, die eine Übersicht der wichtigsten Befehle zu bestimmten Themen erhalten (hier beispielsweise für [Basics in R](https://www.rstudio.com/wp-content/uploads/2016/05/base-r.pdf)). Lernen Sie, sich *selbstständig* Informationen zu beschaffen, denn auch nach langjähriger Erfahrung mit `R` wird das immer wieder notwendig sein. Häufig bedeutet die Arbeit an einer komplexen, neuen Fragestellung: Googeln, googeln, googeln... Wir können Ihnen in der Veranstaltung nicht alle vorhandenen Möglichkeiten vermitteln (weil das `R`-Universum so umfangreich ist), aber wir können Ihnen hoffentlich das Handwerkszeug geben, sich selbst zu helfen! Wenn Sie jedoch nicht weiterkommen, dann *fragen Sie sich untereinander* oder auch Ihre Dozierenden, denn es ist noch kein `R`-Genie vom Himmel gefallen... Generell ist es für Ihr Studium sehr hilfreich, sich frühzeitig ein gutes soziales Netz aufzubauen, in dem Sie sich gegenseitig helfen und unterstützen. Das ist ein wichtiger Prädiktor für Erfolg im Studium (Robbins et al., 2004), und das Studium macht außerdem mehr Spaß! 

**Documentation is key**

Dokumentieren Sie alle Schritte sorgfältig. Strukturieren Sie Ihren Code durch sinnvoll gewählte Überschriften (mittels Kommentarfunktion), sodass Sie auch später wieder verstehen, was Sie beim letzten Mal gemacht haben. Beginnen Sie ganz oben mit dem sogenannten "Set-Up": Titel der Analyse, ggf. Datum, Setzen des Working Directories, Laden der nötigen Pakete, Einlesen der Daten. Kommentieren Sie jeden Schritt sorgfältig und verständlich (spätestens nach zwei Monaten haben Sie sonst garantiert vergessen, was Sie gemeint haben...). Wenn Sie Korrekturen machen, löschen Sie überflüssige Code-Zeilen, um nicht die Übersicht zu verlieren. Achten Sie darauf, dass sich das Working Directory ändert, wenn Sie den Ort eines Ordner auf Ihrem Rechner ändern oder Ordner umbenennen, und passen Sie die Befehle entsprechend an. Zunächst ist die Dokumentation ein zeitaufwendiger Schritt mehr, aber Future-You wird es Ihnen danken. Über die einfachsten Strukturierungsmaßnahmen werden wir gleich in den `R`- Basics nochmal sprechen.

![](/post/comments.jpg){width=40%}
<!-- https://i.redd.it/b9e4xbeg40151.jpg Ich habe keine Ahnung, ob das Bild urheberechtlich geschützt ist, und weiß nicht wie ich es herausfinden könnte-->

**Ausprobieren!**

Scheuen Sie sich nicht, viel auszuprobieren. Oft gibt es viele Wege zum Ziel, und durch das Ausprobieren mehrerer Möglichkeiten lernen Sie umso mehr Vorgehensweisen kennen. Suchen Sie gerne nach alternativen Wegen, probieren Sie andere Funktionen aus, laden Packages herunter und probieren Sie, damit zu arbeiten! Haben Sie keine Angst, etwas falsch zu machen. Durch die Dokumentation (s.o.) können Sie jederzeit, wenn etwas schief gegangen ist, zum vorherigen Schritt zurückkehren, und es nochmal probieren (auch das ist Alltag für alle Anwender:innen!). Behalten Sie immer ein Kopie der Rohdaten, die Sie nicht verändert haben, so können Sie beim Ausprobieren nichts kaputt machen! 


***

### `R`-Basics

#### `RStudio`

Das traditionelle `R` ist im Rahmen seiner Nutzeroberfläche einer Konsole ähnlich und damit nicht sehr benutzerfreundlich. Durch die Erweiterung mit `RStudio` wird die Verwendung deutlich erleichtert, weshalb wir dieses auch herunterladen. 

![](/post/2019-10-18-r-crash-kurs_files/rstudio.png)

`RStudio` besteht aus vier Panels. Wenn wir `RStudio` zum ersten Mal öffnen sind jedoch nur drei sichtbar. Das vierte wird durch das Öffnen eines neuen Files sichtbar (oder auch durch **Strg+Shift+n** bzw. in OS X: **Cmd+Shift+n**). 

Zunächst betrachten wir das Fenster unten links - die Konsole. In dieser kann Code ausgeführt werden. Beispielsweise können wir dort eine Addition eingeben und erhalten nach dem Drücken von **Enter** dann das Ergebnis der Operation.

```{r}
2 + 1
```

Auf diese Weise kann man zwar Aktionen ausführen, hat nach dem Schließen von `RStudio` aber keine Dokumentation, was man durchgeführt hat. Dafür ist das Script, also das eben neu geöffnete File, im linken oberen Fenster gedacht. Dort kann Code geschrieben und später auch gespeichert werden. Wenn wir unsere Addition nun dort notieren und anschließend **Enter** drücken passiert erstmal nichts. Damit etwas passiert, muss die Syntax mit Run Button  ![](/post/2019-10-18-r-crash-kurs_files/run.png) oder mit  **Strg+Return** (OS X: **cmd+Return**) ausgeführt werden. Das Ergebnis wird aber nicht im Script selbst, sondern in der Konsole angezeigt.

Oben rechts wird per Voreinstellung das *Environment* angezeigt, das wir gleich noch füllen werden. Unten rechts gibt es verschiedene Tabs wie beispielsweise die Hilfe und die Anzeige von Plots.

#### Strukturierung und einfache Operationen

Wir haben bereits eine Addition in unser Script geschrieben. Auch wenn wir dieses in zwei Jahren nochmal öffnen, werden wir uns wohl daran erinnern, was dieser Befehl macht. Das ist aber - wie wir bereits in den allgemeinen Hinweisen beschrieben haben - nicht immer so klar. Damit wir auch später noch wissen, weshalb wir eine Operation durchführen brauchen wir also *Kommentare*. In `R` werden sie durch (beliebig viele) `#` begonnen und enden bei einem Zeilenumbruch. Mit Kommentaren kann Syntax auch in verschiedene Abschnitte gegliedert werden. Wir empfehlen, Abschnittüberschriften mit `####` zu beginnen und mit `----` zu beenden. `RStudio` erkennt solche Kommentare automatisch als Überschriften und stellt über den ![](/post/2019-10-18-r-crash-kurs_files/outline.png) Button eine darauf basierende Gliederung zur Verfügung.

Beispielsweise könnten wir also unser Skript nun folgendermaßen besser lesbar machen.

```{r}
#### Wiederholung in R ----

1 + 2   # Addition
```

In der Gliederung sollte in `RStudio` jetzt die Überschrift "Wiederholung in R" auftauchen.

Neben einfachen Taschenrechner-Funktionen mit *numerischen Ergebnissen* kann R auch logische Abfragen und Vergleiche durchführen. Hier folgt ein Beispiel für das Prüfen auf Gleichheit:

```{r}
3 == 4   # Logische Abfrage auf Gleichheit
```

Die Ergebnisse dieser Abfragen sind *boolesch* - also immer entweder wahr (`TRUE`) oder falsch (`FALSE`).

[Hier](https://www.statmethods.net/management/operators.html) finden Sie weiterführende Informationen und eine Übersicht zu Rechenoperationen und logischen Abfragen.

#### Funktionen und Argumente

Die Umsetzung der Addition anhand normaler Zeichen ist recht simpel. Das ist jedoch eher eine Ausnahme, weshalb es in `R` vorprogrammierte Funktionen gibt. Für unsere bisherige Operation könnte man beispielsweise folgende Funktion nutzen:

```{r}
sum(1, 2) # Addition durch Funktion
```

Hier wird die Funktion `sum` genutzt, um eine Summe der Argumente (`1` und `2`) zu bilden. An diesem Beispiel lässt sich bereits die generelle Struktur von Funktionen in `R` erkennen:

```
funktion(argument1, argument2, argument3, ...)
```

Wenn Argumente verschiedene Funktionen haben, sollten sie auch benannt werden. Ein einfaches Beispiel ist das Runden von Zahlen. Hier gibt es zusätzlich zu der Zahl auch die Menge an Nachkommastellen, die angegeben werden soll. Funktionen in `R` haben die Grundstruktur `funktionsname(argument1 = ..., argument2 = ..., argument3 = ...)`. Die Argumente, die eine Funktion erwartet, können mit `args()` abgefragt werden. 

```{r}
args(round)
```

Testen Sie diese Möglichkeit mit anderen Funktionen, die Sie aus dem letzten Semester kennen! Wenn es einen Default-Wert für ein Argument gibt, wird er hier hinter dem `=` angezeigt. Bei `round` sagt uns der Ausdruck `digits = 0`, dass per default auf 0 Nachkommastellen gerundet wird.

```{r}
round(1.2859)
```

Wenn wir diesen Default-Wert überschreiben, können wir stattdessen bspw. auf 2 Stellen runden. 

```{r}
round(1.2859, digits = 2)
``` 

Argumente können durch die korrekte Reihenfolge oder durch explizite Benennung angesprochen werden. Wenn wir beispielsweise in der `round` Funktion die Reihenfolge der Argumente vertauschen, aber den Namen des Argumentes verwenden, funktioniert die Ausführung trotzdem.

```{r round}
round(digits = 2, x = 1.2859)
``` 

In den allgemeinen Arbeitshinweisen haben wir bereits die interne Hilfe in `R` angesprochen. Anstatt nach der Funktion im Tab Help zu suchen, können Sie mit `?` oder `help()` die Hilfe aufrufen, um sich detaillierte Informationen zu dieser Funktion ausgeben zu lassen. Nutzen Sie diese Möglichkeit immer, wenn Ihnen die Anwendung einer Funktion nicht klar ist. 

#### Objekte und das Environment

Objekte dienen dazu, Ergebnisse abzulegen und diese in einer anderen Funktion zu verwenden. Die Zuweisung eines Ergebnisses zu einem Objekt erfolgt über den sog. Zuweisungspfeil `<-`.

```{r}
#### Objekte ----
my_num <- sum(3, 4, 1, 2) # Objekt zuweisen
```

Anders als zuvor wird in diesem Fall in der Konsole kein Ergebnis ausgedruckt, sondern lediglich der Befehl gespiegelt. Das Ergebnis der Summen-Funktion ist im Objekt `my_num` abgelegt. Dieses Objekt sollte nun auch im Panel oben rechts - spezifischer im Tab *Environment* - aufgetaucht sein. Nun können wir den Inhalt des Objektes an eine Funktionen weiterreichen zu können. In diesem Beispiel nutzen wir `sqrt` - die Berechnung einer Wurzel.

```{r}
sqrt(my_num) # Objekt in Funktion einbinden
```

Der Inhalt des Objektes wird so als Argument in die Funktion `sqrt` übergeben. Das ist letztlich das Gleiche wie

```{r}
sqrt(sum(3, 4, 1, 2)) # Verschachtelte Funktionen
```

wo das Ergebnis nicht explizit in einem Objekt gespeichert wird, sondern direkt als Argument an eine Funktion weitergegeben wird. Dabei werden geschachtelte Funktionen von innen nach außen evaluiert. Die Aneinanderkettung von Objektzuweisungen und Schachtelungen ist unbegrenzt, sodass sehr komplexe Systeme entstehen können. Weil das aber sehr schnell anstrengend werden kann - und man dabei leicht den Überblick verliert, was eigentlich wann ausgeführt wird - gibt es noch eine weitere Variante, Funktionen aneinander zu reihen: die *Pipe*.

Bei der Pipe `|>` wird ein links stehendes Objekt oder Ergebnis genommen und als *erstes Argument* der rechts stehenden Funktion eingesetzt. Für unser Wurzelbeispiel also:

```{r}
sum(3, 4, 1, 2) |> sqrt() # Nutzung Pipe
```

Das hat den immensen Vorteil, dass wir dadurch unseren Code wieder in der, im westlichen Kulturkreis üblichen Variante wie Text von links nach rechts lesen können. Dabei ist das was als erstes passiert links, das Ergebnis wird nach rechts weitergereicht und irgendetwas passiert damit. Ergebnisse, die man später noch braucht, sollten aber immer in einem Objekt abgelegt werden.


#### Vektoren und Matrizen 

##### Vektoren 

Vektoren sind ein spezieller Typ für Objekte, die in `R` durch den eben verwendeten Befehl `c()` erstellt werden können:

```{r}
zahlen <- c(8, 3, 4)
```

Wird eine Rechenoperation auf einen Vektor angewandt, so wird die Operation elementeweise vorgenommen. Hier sehen Sie, dass jedes einzelne Element des Vektors `zahlen` mit 3 multipliziert wird. 

```{r}
zahlen * 3
```

Vektoren können unterschiedlicher Art sein:

Typ | Kurzform | Inhalt
--- | -------- | ------
`logical` | `logi` | wahr (`TRUE`) oder falsch (`FALSE`)
`numeric` | `num` | Beliebige Zahlen
`character` | `char` | Kombinationen aus Zahlen und Buchstaben
`factor` | `fac` | Faktor mit bestimmter Anzahl an Stufen

Für einen vorhandenen Vektor kann die Klasse über die Funktion `str()` ermittelt werden. 

```{r}
str(zahlen)
```

Über die Funktion `as.character()` können die Elemente eines Vektors in Zeichen umgewandelt werden. Neben der Angabe `chr` sehen Sie auch, dass die Zahlen nun in Anführungszeichen dargestellt werden.

```{r}
zeichen <- as.character(zahlen)
str(zeichen)
```

Wenn Sie nun beispielsweise eine mathematische Funktion auf diesen Vektor anwenden würden, erhalten Sie eine Fehlermeldung. 

```{r, error=T}
zeichen * 3
```

Nutzen Sie die Möglichkeit, die Klasse eines Objektes zu erfragen (`str()`) deshalb auch, wenn Sie eine Fehlermeldung erhalten, um zu prüfen, ob ein Vektor die richtige Klasse hat.

##### Matrizen

Matrizen sind eine der vier Formen, in der in `R` mehrere Vektoren in einem gemeinsamen Objekt abgelegt werden können:

Typ | Dimensionen | Inhalt
--- | --------------- | ------
`matrix` | 2 | Vektoren des gleichen Typs
`array` | $n$ | Vektoren des gleichen Typs
`data.frame` | 2 | Vektoren der gleichen Länge
`list` | 1 | Beliebige Objekte

Sie können mit dem `matrix()`-Befehl angelegt werden:

```{r}
mat<- matrix(c(7, 3, 9, 1, 4, 6), ncol = 2)
```

Schauen Sie sich die erstellte Matrix an, in dem sie `mat` ausführen. Prüfen sie mit dem Befehl `str()`, von welcher Art die erstellte Matrix ist. 

```{r}
mat
str(mat)
```

Auf die Elemente innerhalb von Matrizen kann man über die sogenannte Indizierung zugreifen, indem man Zeile und Spalte nach der folgenden Form ansteuert: `[Zeile, Spalte]`. Das Element in der dritten Zeile und der ersten Spalte erreichen wir also über:
```{r}
mat[3, 1]
```

Die Dimensionen einer Matrix lassen sich bestimmen über: 
```{r}
nrow(mat)
ncol(mat)
dim(mat) #alternativer Befehl
```

In der Vorlesung wurden verschiedene Matrixoperationen besprochen. Alle diese Operationen sind auch in `R` implementiert und über einfache Befehle nutzbar. 

Hier ein Überblick über die in der Vorlesung behandelten Matrixoperationen und ihre Umsetzung in `R` (`m` steht dabei immer für eine beliebige Matrix):

![](/post/Matrixoperationen.png){width=100%}

#### Einlesen von Datensätzen

In der praktischen Nutzung bekommt man es mit Datensätzen in den unterschieldlichsten Dateiformaten zu tun. `R` kann Daten aus sehr vielen Formaten einlesen (.csv, .sav, .txt, .dat, ...). Teilweise müssen dafür spezielle Packages benutzt werden. Häufig empfiehlt sich (außerhalb der `R`-eigenen Formaten) die Nutzung von csv-Dateien. Hier finden Sie eine [Zusammenfassung](https://de.wikibooks.org/wiki/GNU_R:_Datenimport_und_-export) dazu. Wenn Daten bereits im `R`-eigenen .rda-Format vorliegen, können diese über den Befehl `load()` eingelesen werden.

Wir müssen `R` nur mitteilen, wo der Datensatz liegt et voilà, er wird uns zur Verfügung gestellt. Liegt der Datensatz bspw. auf dem Desktop, so müssen wir den Dateipfad dorthin legen und können dann den Datensatz laden (wir gehen hier davon aus, dass Ihr PC "Musterfrau" heißt):

```{r, eval = FALSE}
load("C:/Users/Musterfrau/Desktop/mach.rda")
```

Bei Dateipfaden ist darauf zu achten, dass bei  Linux `r fontawesome::fa("linux")` oder Mac OS Rechnern `r fontawesome::fa("apple")` immer Front-Slashes ("/") zum Anzeigen von Hierarchien zwischen Ordnern verwendet werden, während auf Windows Rechnern `r fontawesome::fa("windows")` im System aber bei Dateipfaden mit Back-Slashes gearbeitet wird ("\\"). `R` nutzt auf Windows Rechnern `r fontawesome::fa("windows")` ebenfalls Front-Slashes ("/").  Das bedeutet, dass, wenn wir auf Windows Rechnern `r fontawesome::fa("windows")` den Dateipfad aus dem Explorer kopieren, wir die Slashes "umdrehen" müssen.

Genauso sind Sie in der Lage, den Datensatz direkt aus dem Internet zu laden. Hierzu brauchen Sie nur die URL und müssen `R` sagen, dass es sich bei dieser um eine URL handelt, indem Sie die Funktion `url` auf den Link anwenden. Der funktionierende Befehl sieht so aus (wobei die URL in Anführungszeichen geschrieben werden muss):

```{r}
load(url("https://pandar.netlify.app/post/mach.rda"))
```

Durch die Betrachtung dieses Link erkennen wir, dass Websiten im Grunde auch nur sehr anschaulich dargestellte Ordnerstrukturen sind. So liegt auf der Pandar-Seite, die auf *netlify.app* gehostet wird, ein Ordner namens *post*, in welchem wiederum das `mach.rda` liegt.

Die hier verwendeten Daten stammen aus dem ["Open-Source Psychometrics Project"](https://openpsychometrics.org/_rawdata/), einer Online-Plattform, die eine Sammlung an Daten aus verschiedensten Persönlichkeitstests zur Verfügung stellt. Wir haben bereits eine kleine Aufbereitung der Daten durchgeführt, damit wir leichter in die Analysen starten können. Auf der genannten Seite kann man Fragebögen selbst ausfüllen, und so zum Datenpool beitragen. Der hier verwendete Datensatz enthält Items aus einem Machiavellismus-Fragebogen, den Sie bei Interesse [hier](https://openpsychometrics.org/tests/MACH-IV/) selbst ausfüllen können.




#### Überblick im Datensatz

Wir können uns die ersten (6) Zeilen des Datensatzes mit der Funktion `head` ansehen. Dazu müssen wir diese Funktion auf den Datensatz (das Objekt) `mach` anwenden:

```{r}
head(mach) # ersten 6 Zeilen
```

Da es sich bei unserem Datensatz um ein Objekt vom Typ `data.frame` handelt, können wir die Variablennamen des Datensatzes außerdem mit der `names`-Funktion abfragen. Eine weitere interessante Funktion ist `dim`, die die Anzahl der Zeilen und Spalten ausgibt. 

```{r}
names(mach) # Namen der Variablen

dim(mach) # Anzahl der Zeilen und Spalten 
```

Die ersten Items beschäftigen sich mit den üblichen Persönlichkeitseigenschaften. Anschließend gibt es einige demografische Angaben wie Alter oder auch Geschlecht. Die letzten Variablen repräsentieren Eigenschaften des Machiavellismus. Die Bedeutung von einzelnen Variablen wird erläutert, wenn Sie diese einsetzen. 

#### Einfache Deskriptivstatistik

Um auf einzelne Variablen in einem Datensatz zuzugreifen, kann man das `$`-Zeichen nutzen, und dann Funktionen auf die angesprochene Variable anwenden. Der Mittelwert wird mit der Funktion `mean` berechnet. Eine Schätzung für die Populationsvarianz erhalten wir mit `var`. Wir wenden diese uns bekannten Funktionen auf die Variable `cvhn` an. Diese gibt an, ob eine Person eine zynische Sichtweise auf die menschliche Natur hat. 

```{r}
mean(mach$cvhn)    # Mittelwert
var(mach$cvhn)     # geschätzte Populationsvarianz
```

Alternativ kann man analog zu oben auch die bereits besprochene Indizierung über eckige Klammern nutzen, um eine oder mehrere Variablen oder Beobachtungen auszuwählen. Unsere Variable ist dabei in Spalte 25 zu finden.

```{r}
mean(mach[,1]) #Alle Zeilen, Spalte 25
```

Um eine Anzahl an Beobachtungen für eine bestimmte Variable zu bestimmen, kann mit der `table`-Funktion gearbeitet werden. Überprüfen wir die Häufigkeiten für die Variable, ob die Muttersprache Englisch ist `engnat`.

```{r}
table(mach$engnat)
str(mach$engnat)
```
Wir sehen, dass die Variable noch als numerisch hinterlegt ist. Wir wollen jedoch den Zahlen die Bedeutung zuordnen und so einen Faktor erstellen. Diesen werden wir später noch verwenden.

```{r}
mach$engnat <- factor(mach$engnat,                # Ausgangsvariable
                      levels = 1:2,               # Faktorstufen
                      labels = c("Ja", "Nein"))   # Bedeutung

str(mach$engnat)                                  # Test der Umwandlung
```

#### Packages 

Sogenannte Pakete stellen zusätzliche Funktionen zur Verfügung, die in base `R` nicht verfügbar sind. Aktuell sind in dem offiziellen Repository für `R` über 15.000 ergänzende Pakete verfügbar. Sehen Sie sich hier die vollständige [Liste](https://cran.r-project.org/web/packages/) an. Wenn Sie nach einem Paket für einen bestimmten Zweck suchen, ist es jedoch leichter, eine konventionelle Suchmaschine zu nutzen. Ein gutes Paket für die einfache Berechnung vieler deskriptiver Werte ist `psych` (mit der Funktion `describe`). Ohne Installation und Aktivierung ist diese nicht verfügbar.

```{r, error = T}
describe(mach$cvhn)
```

Pakete müssen vor der ersten Nutzung zunächst einmal heruntergeladen werden. Für einige von Ihnen wird dieser Schritt nicht nötig sein, da Sie es bereits heruntergeladen haben.

```{r, eval = FALSE}
install.packages("psych")
```

Danach muss man ein Package aus der library laden. Dies muss nach jedem Neustart von `R` erneut erfolgen, damit das Package genutzt werden kann. 

```{r}
library(psych)
describe(mach$cvhn)
```



#### Zusammenhang und lineare Regression

Die lineare Regression ist eine sehr einfache Analyse, um den Zusammenhang zwischen zwei Variablen zu untersuchen. Wir wollen die bereits betrachtete zynische Sichtweise auf die menschliche Natur `cvhn` als Kriterium nutzen. Prädiktor wird die positive Sichtweise auf die menschliche Natur `pvhn`. Man sollte von einem negativen Zusammenhang der Werte ausgehen.

Natürlich ist die Regressionsanalyse nicht ohne Voraussetzungen. Diese werden wir in den nächsten Wochen nochmal besprechen, an dieser Stelle also nicht betrachten. Eine simple Darstellung des Zusammenhangs kann man über die `plot`-Funktion abbilden. Schönere Grafiken erhält man mittels `ggplot`, was in der nächsten Sitzung unser Thema wird.

```{r}
plot(mach$pvhn, mach$cvhn, xlab = "Positive Sichtweise", ylab = "Negative Sichtweise")
```

Gerade in diesem Plot sieht man, dass die Standardfunktionalität von `R` mit der Menge an Personen im Datensatz nicht zurechtkommt. Die Umsetzung der Parameterschätzung anhand der kleinsten Quadrate ist mit der Funktion `lm` möglich. Beachten Sie hierbei, dass angegeben wird, welche Variable durch welche Variable vorhergesagt wird. Das bedeutet, dass wir hier zuerst die zynische Sichtweise und dann das Alter nennen müssen.

```{r}
lm(cvhn ~ pvhn, mach) # lineare Regression
```

Das Steigungsgewicht ist wie erwartet negativ. Der hier gegebene Output enthält zwar die wichtigsten Informationen, doch wird eigentlich noch viel mehr innerhalb der Funktion berechnet. Dies ist ein gutes Beispiel dafür, dass es manchmal Sinn ergibt, auch die Ergebnisse der Analyse in ein Objekt abzulegen.

```{r}
model <- lm(cvhn ~ pvhn, mach)  # Objektzuweisung
```

Beispielsweise können wir wie bereits angedeutet die Funktion `summary` verwenden, um eine Zusammenfassung der Ergebnisse zu erhalten.

```{r}
summary(model)
```

Hier werden uns neben dem Steigungskoeffizienten und dem Achsenabschnitt auch noch beispielsweise deren Signifikanz und $R^2$ angezeigt. Beide werden hier als signifikant angegeben. Es handelt sich um einen mittleren Effekt.

Doch es gibt noch einige weitere Informationen, die von der Funktion `lm` abgelegt werden. Die Bezeichnung der Einträge in der Liste `model` kann über `names` abgefragt werden.

```{r}
names(model) #andere Inhalte der Liste
```

Die weiteren Inhalte umfassen unter anderem die `residuals`, die für das Prüfen der Voraussetzungen wichtig wären, aber auch die vorhergesagten Werte (`fitted.values`). 

Nachdem wir nun eine kurze Wiederholung zur Analyse zum Zusammenhang zwischen zwei Variablen betrachtet haben, geht es im folgenden Teil um den Unterschied zwischen Gruppen.

#### Der $t$-Test

Der $t$-Test stellt einen sehr einfachen Test auf einen Gruppenunterschied dar. Mithilfe dieses Tests soll untersucht werden, ob die Mittelwerte in zwei Gruppen gleich sind. Dazu brauchen wir drei wichtige Annahmen. Auch hier werden wir uns mit dem Prüfen der Voraussetzungen nicht nochmal genauer beschäftigen und gehen davon aus, dass diese gegeben sind. Sie können diese [hier](/post/gruppenvergleiche-unabhaengig/) nochmal nachlesen.

In diesem Beispiel wollen wir uns damit beschäftigen, ob der zynische Blick auf die Menschheit in den Gruppen der native english speakers und non-native english speakers hinsichtlich des Mittelwerts gleich verteilt ist. Wir beschäftigen uns mit unabhängigen Stichproben. Für die Testung  wird als Null-Hypothese die Gleichheit der Mittelwerte in den beiden Gruppen formuliert.

$$H_0: \mu_1=\mu_2$$
Diese Hypothese gilt nicht, wenn $\mu_1\neq\mu_2$. In diesem Fall gilt irgendeine Alternativhypothese ($H_1$) mit einer Mittelwertsdifferenz $d=\mu_1-\mu_2$, die nicht Null ist $(d\neq0)$.

Die Umsetzung in `R` ist dabei nicht schwer und funktioniert mittels `t.test`. Dabei müssen einige Argumente eingegeben werden. Zunächst geht es darum, unabhängige (`engnat`) und abhängie Variabe (`cvhn`) für den Test festzulegen. In `data` muss festgehalten werden, in welchem Datensatz diese Variablen zu finden sind. Unter `paired` wird mit `FALSE` festgehalten, dass wir unabhängige Stichproben betrachten. Eine ungerichtete Hypothese ergibt für das Argument `alternative` den Input `two.sided`. Wir setzen die Varianzhomogenität `var.equal` auf `TRUE`, da wir wie beschrieben von der Erfüllung der Voraussetzungen ausgehen. Als Sicherheitsniveau (`conf.level`) legen wir `0.95` fest, was dann einem $\alpha$-Niveau von `0.05` entspricht.


```{r, echo = F}
ttest <- t.test(cvhn ~ engnat,  # abhängige Variable ~ unabhängige Variable
       data = mach, # Datensatz
       paired = FALSE, # Stichproben sind unabhängig 
      alternative = "two.sided",        # zweiseitige Testung (Default)
      var.equal = TRUE,                 # Homoskedastizität liegt vor (-> Levene-Test)
      conf.level = .95)                 # alpha = .05 (Default)
```

```{r}
t.test(cvhn ~ engnat,  # abhängige Variable ~ unabhängige Variable
       data = mach, # Datensatz
       paired = FALSE, # Stichproben sind unabhängig 
      alternative = "two.sided",        # zweiseitige Testung (Default)
      var.equal = TRUE,                 # Homoskedastizität liegt vor (-> Levene-Test)
      conf.level = .95)                 # alpha = .05 (Default)
```

Der Output enthält folgende Informationen:

```{r, echo = F}
output <- capture.output(
  t.test(cvhn ~ engnat,
       data = mach, 
       paired = FALSE,
       alternative = "two.sided",
      var.equal = TRUE,
      conf.level = .95))

cat(paste(output[1:3], collapse = "\n"))
```
zeigt an, dass es sich um einen Zwei-Stichproben $t$-Test handelt.

```{r, echo = F}
cat(paste(output[4:5], collapse = "\n"))
```
zeigt uns die Datengrundlage (`X` und `Y`), den $t$-Wert, die $df$ und den $p$-Wert. 

$t$-Wert =`r round(ttest$statistic, 4)` und $p$-Wert $p\approx$ `r round(ttest$p.value, 4)`, somit ist dieser Mittelwertsvergleich auf dem 5% Niveau signifikant ($p < .05$). 

```{r, echo = F}
cat(paste(output[6:12], collapse = "\n"))
```

zeigt uns die Alternativhypothese ($H_1:d \neq 0$), das Konfidenzintervall der Mittelwertsdifferenz sowie die Mittelwerte in den beiden Gruppen. Dadurch können wir auch erkennen, dass die empirische Mittelwertsdifferenz bei liegt.

Wie bei der Regression können wir auch den Test als Objekt ablegen. Wenn wir `names` darauf anwenden, sehen wir wieder alle Namen, die wir hinter `$` schreiben können.

```{r}
ttest <- t.test(cvhn ~ engnat,  # abhängige Variable ~ unabhängige Variable
       data = mach, # Datensatz
       paired = FALSE, # Stichproben sind unabhängig 
      alternative = "two.sided",        # zweiseitige Testung (Default)
      var.equal = TRUE,                 # Homoskedastizität liegt vor (-> Levene-Test)
      conf.level = .95)                 # alpha = .05 (Default)
names(ttest)    # alle möglichen Argumente, die wir diesem Objekt entlocken können
ttest$statistic # (empirischer) t-Wert
ttest$p.value   # zugehöriger p-Wert
```

Da die Null-Hypothese verworfen wird, nehmen wir an, dass es in der Population einen Mittelwertsunterschied hinsichtlich des zynischen Blickes auf die Menschheit gibt.

Nun sind wir am Schluss des behandelten Codes in der Seminar-Sitzung angekommen. Die Grundlagen von `R` und einigen statistischen Verfahren sind nun aufgefrischt und wir können mit Mut ins zweite Semester starten! 



***

## R-Skript
Den gesamten `R`-Code, der in dieser Sitzung genutzt wird, können Sie [`r fontawesome::fa("download")` hier herunterladen](/post/PsyBSc7_R_Files/Wiederholung.R).

***

## Appendix

### Appendix A {#AppendixA}
<details><summary>**Dokumente erstellen mit `R`**</summary>
blala

#### Markdown-Dateien erstellen

Ein R-Markdown ist ein Dokument, welches im R-Editor erstellt wird, und sowohl Textbestandteile als auch R-Code enthalten kann. Dieses Dokument wird in R erstellt und bearbeitet, und kann danach z.B. als Word-, PDF- oder HTML-Datei ausgegeben werden. Ein Markdown besteht aus freien Textbereichen und aus sogenannten R-Chunks (Absätzen mit R-Code). In Textabsätzen können bestimmte Befehle genutzt werden, um die Formatierung des Textes (Überschriften, Fettdruck, etc.) anzupassen. Markdowns sind beispielsweise nützlich, um Berichte über Datenauswertungen zu schreiben, in denen Analysen und deren Beschreibung sowie Interpretation in einem Dokument gebündelt werden. Ergebnisse können direkt in den Text übernommen werden, was viel Arbeit und Fehler sparen kann.

Hier finden Sie eine sehr [ausführliche Anleitung](https://rmarkdown.rstudio.com/lesson-1.html) für die Arbeit mit Markdowns. Hier finden Sie ein sogenanntes [Cheatsheet](https://rstudio.com/wp-content/uploads/2015/06/rmarkdown-german.pdf) für R-Markdown, das viele wichtige Befehle kurz und knapp zusammenfasst.

##### Schritte zur Erstellung eines Markdowns

- File -> New File -> R Markdown 
![](/post/Screenshot1.png){width=30%}

- Zielformat festlegen (Word, PDF, HTML...) und Titel geben
![](/post/Screenshot2.png){width=60%}

- Das Skript, das dadurch erstellt wird ist eine Schablone mit Vorlagen für Freitext und R-Chunks und wichtigen Hinweisen für die Erstellung. Hier finden Sie viele Informationen, die Ihnen beim Bearbeiten Ihres Markdowns helfen. Diese Vorlage können Sie ganz einfach weiterbearbeiten, um Ihr eigenes Dokument zu erstellen. 
![](/post/Screenshot3.png){width=70%}

- Indem Sie auf Knit (engl. "Stricken") klicken, wird das Dokument in Zielformat erstellt. Ohne Änderungen an der Vorlage können Sie das Skript knitten, und sehen schon einmal, wie das finale Dokument aussehen wird. Wenn Sie Änderungen vornehmen, können Sie immer wieder überprüfen, wie sich das auf das erstellte Dokument auswirkt. 
![](/post/Screenshot4.png){width=70%}

#### Papaja

Besonders hilfreich ist das Package *papaja* (Prepare Reproducible APA Journal Articles with R Markdown), mit dem `R`Markdown-Dokumente automatisch in das APA-Format gebracht werden. Neben der korrekten Zitierweise können damit Tabellen und Abbildungen im passenden Format erstellt werden. 

Wenn Sie das *papaja*-Package installiert haben, können Sie bei der Erstellung eines Markdowns mit den gleichen Schritten wie oben, unter Template den "APA article" auswählen, wodurch automatisch alle Einstellungen passend vorgenommen werden:

![](/post/Screenshot5.png){width=70%}

Das [Manual für die Anwendung](http://frederikaust.com/papaja_man/index.html) finden Sie online. 

</details>

***

## Literatur

Fox, J. & Weisberg, S. (2019). An {R} Companion to Applied Regression, Third Edition. Thousand Oaks CA: Sage. URL: [https://socialsciences.mcmaster.ca/jfox/Books/Companion/](https://socialsciences.mcmaster.ca/jfox/Books/Companion/)

Revelle, W. (2020) psych: Procedures for Personality and Psychological Research, Northwestern University, Evanston, Illinois, USA, [https://CRAN.R-project.org/package=psych](https://CRAN.R-project.org/package=psych) Version = 2.0.9.

Robbins, S. B., Lauver, K., Le, H., Davis, D., Langley, R., & Carlstrom, A. (2004). Do psychosocial and study skill factors predict college outcomes? A meta-analysis. Psychological bulletin, 130(2), 261.

