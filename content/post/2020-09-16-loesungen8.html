---
title: Lösungen
author: Christina Berger
date: '2020-09-16T20:00:00'
slug: loesungen8
categories:
  - Projekt 8
tags: []
subtitle: ''
summary: ''
authors: [berger, mehler]
lastmod: '2020-09-16'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
header:
  image: "/header/API_post.jpg"
  caption: '[Unsplash](https://images.unsplash.com/photo-1527474305487-b87b222841cc?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1267&q=80)'
---



<div id="vorwarnung" class="section level2">
<h2>Vorwarnung</h2>
<p>Achtung! Im Folgenden werden die Lösungen für das achte Projekt präsentiert. Falls du das Projekt noch nicht vollständig bearbeitet hast, nutze zunächst die <a href="/post/tipps8">Tipps</a>. Sofern dir die Tipps für einen Teil nicht geholfen haben, kannst du die Lösungen dafür benutzen, einen Schritt weiterzukommen und beim nächsten Abschnitt weiterzumachen.</p>
</div>
<div id="variable-auswählen" class="section level2">
<h2>Variable auswählen</h2>
<p><details><summary>Abschnitt anzeigen</summary></p>
<p>Bevor du anfängst, lädst du am besten die Pakete, welche du für dieses Projekt benötigst:</p>
<pre class="r"><code>#install.packages(&quot;httr&quot;)
#install.packages(&quot;jsonlite&quot;)
#install.packages(&#39;OData&#39;)
#install.packages(&#39;data.table&#39;)
library(data.table)
library(OData)
library(httr)
library(jsonlite)</code></pre>
<p>Im ersten Schritt musst du dir dann eine Variable aussuchen. Dafür lädst du zunächst die Daten der Indikatoren herunter.</p>
<pre class="r"><code>Indikatoren &lt;- retrieveData(&#39;https://ghoapi.azureedge.net/api/Indicator&#39;)</code></pre>
<p>Da wir uns die verschachtelte Liste nur schwer anzeigen lassen können, wandeln wir sie in ein Dataframe um.</p>
<pre class="r"><code>Indi &lt;- as.data.frame(Indikatoren)</code></pre>
<p>Somit bekommen wir ein sehr langes Dataframe, bei dem in der ersten Zeile der Variablenname steht, in der zweiten Zeile die Beschreibung zu der Variable und in der dritten Zeile die Sprache.</p>
<p>Wenn du dir die Indikatoren lieber als Matrix anzeigen lassen willst, musst du zunächst den Befehl <code>unlist</code> anwenden.</p>
<pre class="r"><code>a &lt;- unlist(Indikatoren)
ma &lt;- as.matrix(a)</code></pre>
<p>Hier hast du nun eine Spalte, in der erst der Vairablenname steht, darunter steht die Beschreibung zu der Variable und wiederum darunter steht die Sprache zu der Variable, welche meistens Englisch ist.</p>
<p>Ich werde im Folgenden mit der Variable <code>WHOSIS_000001</code> zur Lebenserwartung arbeiten, aber es sollte mit jeder anderen Variable genauso funktionieren. </details></p>
</div>
<div id="daten-über-die-api-herunterladen" class="section level2">
<h2>Daten über die API herunterladen</h2>
<p><details><summary>Abschnitt anzeigen</summary></p>
<p>Die Daten, mit denen wir arbeiten wollen, können wir auf die gleiche Art und Weise herunterladen, wie die Indikatoren: mit dem Befehl <code>retrieveData</code>. Das Einzige, was wir für den Befehl benötigen, ist die richtige URL.</p>
<p>Für die Daten der WHO ist der grundlegende Befehl <code>https://ghoapi.azureedge.net/api</code>. Da ich die Variable mit den Daten zur Lebenserwartung laden möchte, füge ich dem Link ein <code>/</code> + <code>WHOSIS_000001</code> an. Damit sieht der vollständige Link folgendermaßen aus: <code>https://ghoapi.azureedge.net/api/WHOSIS_000001</code> und kann zum Laden der Daten verwendet werden.</p>
<pre class="r"><code>data &lt;- retrieveData(&#39;https://ghoapi.azureedge.net/api/WHOSIS_000001&#39;)</code></pre>
<p>Diese Daten liegen nun wieder in einer verschachtelten Liste vor. Wenn wir uns die Variable <code>value</code> anschauen, sehen wir jedoch, dass es sich diesmal nicht um <code>character</code>, sondern um weitere Listen in der Liste handelt. Für diese Art von verschachtelten Listen gibt es einen einfachen Befehl aus dem <code>data.table</code>-Paket, welches mit dem Befehl <code>rbindlist</code> verschachtelte Listen in einfache Dataframes konvertiert. Dabei musst du nur beachten, dass du <code>fill</code>= TRUE setzt.</p>
<pre class="r"><code>data1 &lt;- rbindlist(data$value, fill = T)</code></pre>
<pre><code>## Warning in rbindlist(data$value, fill = T): Column 9 [&#39;Dim2Type&#39;] of item 1 is
## length 0. This (and 76040 others like it) has been filled with NA (NULL for list
## columns) to make each item uniform.</code></pre>
<p>Somit haben wir ein vollständiges Dataframe, mit dem wir nun das User Interface erstellen können. </details></p>
</div>
