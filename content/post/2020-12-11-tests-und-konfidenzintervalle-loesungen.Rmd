---
title: Tests und Konfidenzintervalle - Lösungen
author: 
date: '2020-12-11'
slug: tests-und-konfidenzintervalle-loesungen
categories:
  - BSc2
tags:
  - t-Test
subtitle: ''
summary: ''
authors: [scheppa-lahyani, nehler]
lastmod: '2020-12-11T19:09:16+01:00'
featured: no
header:
  image: "/header/BSc2_Tests.jpg"
  caption: "[Courtesy of pxhere](https://pxhere.com/de/photo/1240882)"
projects: []
expiryDate: '2022-09-15'
publishDate: '2021-12-16'
---

### Vorbereitung

<details><summary>Lösung</summary>


Laden Sie zunächst den Datensatz `fb21` von der pandar-Website.

```{r}
load(url('https://pandar.netlify.app/post/fb21.rda'))
```

Alternativ können Sie die fertige R-Daten-Datei [<i class="fas fa-download"></i> hier herunterladen](/post/fb21.rda). Die Bedeutung der einzelnen Variablen und ihre Antwortkategorien können Sie dem Dokument [Variablenübersicht.docx](/post/variablen.pdf) entnehmen.

Prüfen Sie zur Sicherheit, ob alles funktioniert hat:

```{r}
dim(fb21)
str(fb21)
```

Der Datensatz besteht aus `r nrow(fb21)` Zeilen (Beobachtungen) und `r ncol(fb21)` Spalten (= Variablen). Falls Sie bereits eigene Variablen erstellt haben, kann die Spaltenzahl natürlich abweichen.


## Aufgabe 1

Im Laufe der Aufgaben sollen Sie auch Funktionen aus Paketen nutzen, die nicht standardmäßig aktiviert und auch eventuell noch nicht installiert sind. Sorgen Sie in dieser Aufgabe zunächst dafür, dass Sie Funktionen aus den Paketen `psych`, `nortest` und `car` nutzbar sind. Denken Sie an die beiden dargestellten Schritte aus dem Tutorial und auch daran, dass eine Installation nur einmalig notwendig ist. 

<details><summary>Lösung</summary>

Installieren aller wichtigen Packages. Beachten Sie, dass das `psych` Paket eventuell schon im Tutorial installiert wurde, weshalb Sie dies nicht nochmal machen müssten.

```{r, eval=F}
install.packages("psych")
install.packages("nortest")
install.packages("car")
```

Damit die Funktionen ansprechbar sind, müssen die Pakete auch noch mittels `load` aktiviert werden.

```{r}
library(psych)
library(nortest)
library(car)
```

</details>



## Aufgabe 2

Die mittlere Lebenszufriedenheit (`lz`) in Deutschland liegt bei $\mu$ = 4.7.

**2.1** Was ist der Mittelwert ($\bar{x}$), die Standardabweichung (*SD*, $\hat\sigma$) und der Standardfehler ($\sigma_{\bar{x}}$) der Lebenszufriedenheit in der Gruppe der Psychologie-Studierenden?

<details><summary>Lösung</summary>

**Variante 1**:

```{r}
mean.lz <- mean(fb21$lz, na.rm = T) #Mittelwert
mean.lz

sd.lz <- sd(fb21$lz, na.rm = T) #Standardabweichung
sd.lz

n.lz <- length(na.omit(fb21$lz)) #Stichprobengröße
se.lz <- sd.lz/sqrt(n.lz) #Standardfehler
se.lz
```

* Der Mittelwert der Lebenszufriedenheit in der Stichprobe liegt bei `r round(mean.lz, digits = 3)`.
* Die Standardabweichung der Lebenszufriedenheit beträgt `r round(sd.lz, digits = 3)`.
* Der Standardfehler der Lebenszufriedenheit beträgt `r round(se.lz, digits = 3)`.

**Variante 2**:

```{r}
describe(fb21$lz) #Funktion aus Paket "psych"
```

</details>



**2.2** Sind die Lebenszufriedenheitswerte normalverteilt? Veranschaulichen Sie dies mit einem geeigneten Plot. Benutzen Sie die `lillie.test`-Funktion aus dem `nortest`-Paket sowie die `qqPlot`-Funktion aus dem `car`-Paket. Wie unterscheiden sie sich? Wann kann man in diesem Fall von einer Normalverteilung ausgehen?

<details><summary>Lösung</summary>

```{r}
#geeigneter Plot: QQ-Plot. Alle Punkte sollten auf einer Linie liegen.
qqnorm(fb21$lz)
qqline(fb21$lz)

#Die qqPlot-Funktion zeichnet ein Konfidenzintervall in den QQ-Plot. Dies macht es für Betrachter:innen einfacher zu entscheiden, ob alle Punkte in etwa auf einer Linie liegen. Die Punkte sollten nicht außerhalb der blauen Linien liegen.
qqPlot(fb21$lz)

#Der Lillie-Test (Kolmogorov-Smirnov Test) testet die H0, dass eine Normalverteilung vorliegt. Daher sollte der Test nicht signifikant sein
lillie.test(fb21$lz)
```
Sowohl der QQ-Plot als auch der Lilliefors-Test prüfen die Daten auf Normalverteilung, wobei der QQ-Plot grafisch und der Lilliefors-Test inferenzstatistisch vorgeht. Beides weist darauf hin, dass die Daten **nicht** normalverteilt sind.

</details>



**2.3** Unterscheidet sich die Lebenszufriedenheit der Psychologie-Studierenden von der Lebenszufriedenheit der Gesamtbevölkerung ($\mu$ = 4.7)? Bestimmen Sie das 99%ige Konfidenzintervall.

<details><summary>Lösung</summary>

Da die Varianz der Grundgesamtheit nicht bekannt ist, wird ein t-Test herangezogen.
Obwohl keine Normalverteilung vorliegt, können wir aufgrund des *zentralen Grenzwertsatzes* trotzdem einen t-Test rechnen.

**Hypothesengenerierung:**

$\alpha$ = .05 

$H_0$: Die durchschnittliche Lebenzufriedenheit der Psychologie-Studierenden $\mu_1$ unterscheidet sich nicht von der Lebenszufriedenheit der Gesamtbevölkerung $\mu_0$.

$H_0$: $\mu_0$ $=$ $\mu_1$

$H_1$: Die durchschnittliche Lebenzufriedenheit der Psychologie-Studierenden $\mu_1$ unterscheidet sich von der Lebenszufriedenheit der Gesamtbevölkerung $\mu_0$.

$H_1$: $\mu_0$ $\neq$ $\mu_1$

```{r}
t.test(fb21$lz, mu=4.7)
t.test(fb21$lz, mu=4.7, conf.level = 0.99) #Default ist 95%, deshalb erhöhen wir auf 99%
```

Mit einer Irrtumswahrscheinlichkeit von 5% kann die $H_0$ verworfen werden. Die Psychologie-Studierenden unterscheiden sich in ihrer Lebenszufriedenheit von der Gesamtbevölkerung. 

</details>



## Aufgabe 3

Die durchschnittliche Abschlussnote im Fach Psychologie (Bachelor) ist 2.01 ($\sigma$ = 0.57). Eine Forschungsgruppe vermutet, dass sich die durchschnittliche Abschlussnote über die Jahre verändert hat und nun besser ist. Um dies zu überpruefen, untersucht die Forschungsgruppe eine zufällige Stichprobe aus 140 Psychologie-Studierenden (*N* = 140). Sie ermitteln eine durchschnittliche Abschlussnote von 1.81.

**3.1** Reicht diese Information aus, um nachzuweisen, dass sich die durchschnittliche Abschlussnote verändert hat? Berechnen Sie wenn möglich, ob es eine Veränderung gab ($\alpha$ = .05).

<details><summary>Lösung</summary>

Ja, diese Informationen reichen aus. Die Standardabweichung der Stichprobe wird nicht benötigt.

**Hypothesengenerierung:**

$\alpha$ = .05 

$H_0$: Die durchschnittliche Abschlussnote der Psychologie-Studierenden $\mu_1$ ist schlechter oder gleich groß wie zuvor ($\mu_0$).

$H_0$: $\mu_0$ $\leq$ $\mu_1$

$H_1$: Die durchschnittliche Abschlussnote der Psychologie-Studierenden $\mu_1$ ist besser als zuvor ($\mu_0$).

$H_1$: $\mu_0$ $>$ $\mu_1$

```{r}
mean.note <- 2.01 #Mittelwert alt
mean.sd <- 0.57 #Standardabweichung alt
n.new.note <- 140 #Stichprobengröße
new.mean.note <- 1.81 #Mittelwert neu
se.mean.note <- 0.57/sqrt(n.new.note) #Standardfehler
z.note <- abs((new.mean.note-mean.note)/se.mean.note) #empirischer z-Wert
z.note

z_krit <- qnorm(1-.05) #kritischer z-Wert
z_krit

z.note > z_krit #Signifikanzentscheidung
```

Mit einer Irrtumswahrscheinlichkeit von 5% wird die $H_0$ (keine Veränderung) verworfen. Die Abschlussnote hat sich über die Jahre verbessert.

</details>



**3.2** Wieviel Prozent der damaligen Fälle hatten eine bessere Abschlussnote als die neue ermittelte Abschlussnote von 1.81?

<details><summary>Lösung</summary>

```{r, echo = FALSE}
p.norm <- pnorm(q = 1.81, mean = 2.01,sd = .57, lower.tail = T)*100
```

```{r}
pnorm(q = 1.81, mean = 2.01,sd = .57, lower.tail = T)*100
```

Nur `r round(p.norm, digits = 2)`% der Fälle hatten eine bessere Abschlussnote als 1.81. Dies unterstützt das Ergebnis, dass sich der neue Wert von dem bisherigen Mittelwert unterscheidet.  

</details>



## Aufgabe 4

**4.1** Unterscheiden sich die Extraversionswerte (`extra`) der Studierenden der Psychologie (1. Semester) von den Extraversionswerten der Gesamtbevölkerung ($\mu$ = 3.5)? Bestimmen Sie das 95%ige Konfidenzintervall und die Effektgröße.

<details><summary>Lösung</summary>

**Hypothesengenerierung:**

$\alpha$ = .05 

$H_0$: Die durchschnittlichen Extraversionswerte der Psychologie-Studierenden $\mu_1$ unterscheiden sich nicht von den Werten der Gesamtbevölkerung $\mu_0$.

$H_0$: $\mu_0$ $=$ $\mu_1$

$H_1$: Die durchschnittlichen Extraversionswerte der Psychologie-Studierenden $\mu_1$ unterscheiden sich von den Werten der Gesamtbevölkerung $\mu_0$.

$H_1$: $\mu_0$ $\neq$ $\mu_1$

```{r}
t.test(fb21$extra, mu=3.5)
```

```{r, echo = FALSE}
t.test1 <- t.test(fb21$extra, mu=3.5)
conf.int1 <- t.test1$conf.int
```

Mit einer Irrtumswahrscheinlichkeit von 5% kann die $H_0$ verworfen werden. Die Psychologie-Studierenden unterscheiden sich in ihrer Extraversion von der Gesamtbevölkerung. 
Das 95%-ige Konfidenzintervall liegt zwischen `r round(conf.int1[1], digits = 2)` und `r round(conf.int1[2], digits = 2)`. Das bedeutet, dass in 95% der Fälle in einer wiederholten Ziehung aus der Grundgesamtheit die mittleren Verträglichkeitswerte zwischen `r round(conf.int1[1], digits = 2)` und `r round(conf.int1[2], digits = 2)` liegen.

**Effektgröße:**

```{r}
mean_extra <- mean(fb21$extra, na.rm = T) #MW der Stichprobe
sd_extra <- sd(fb21$extra, na.rm = T) #Stichproben SD (Populationsschätzer)
mean_Popu_extra <- 3.5 #MW der Grundgesamtheit
d1 <- abs((mean_extra - mean_Popu_extra)/sd_extra) #abs(), da Betrag
d1
```

Die Effektgröße ist mit `r round(d1, digits = 2)` als klein einzuordnen.

</details>



**4.2** Sind die Nerdiness-Werte (`nerd`) der Psychologie-Studierenden (1. Semester) größer als die Nerdiness-Werte der Gesamtbevölkerung ($\mu$ = 2.9)? Bestimmen Sie das 99%ige Konfidenzintervall und die Effektgröße.

<details><summary>Lösung</summary>

**Hypothesengenerierung:**

$\alpha$ = .05 

$H_0$: Die durchschnittlichen Nerdiness-Werte der Psychologie-Studierenden $\mu_1$ sind geringer oder gleich gross wie die Werte der Gesamtbevölkerung $\mu_0$.

$H_0$: $\mu_0$ $\geq$ $\mu_1$

$H_1$: Die durchschnittlichen Nerdiness-Werte der Psychologie-Studierenden $\mu_1$ sind groesser als die Werte der Gesamtbevölkerung $\mu_0$.

$H_1$: $\mu_0$ $<$ $\mu_1$

```{r}
t.test(fb21$nerd, mu=2.9, alternative="greater", conf.level = 0.99)
```

```{r, echo=FALSE}
t.test2 <- t.test(fb21$nerd, mu=2.9, alternative="greater", conf.level = 0.99)
conf.int2 <- t.test2$conf.int
```

Mit einer Irrtumswahrscheinlichkeit von 5% kann die $H_0$ verworfen und die $H_1$ angenommen werden. Die Psychologie-Studierenden haben höhere Nerdiness-Werte im Vergleich zur Gesamtbevölkerung.
Mit einer 99%-igen Wahrscheinlichkeit liegt der wahre Nerdiness-Wert $\mu$ zwischen `r round(conf.int2[1], digits = 2)` und $\infty$ (außerhalb des definierten Wertebereichs).

**Effektgröße:**

```{r}
mean_nerd <- mean(fb21$nerd, na.rm = T) #MW der Stichprobe
sd_nerd <- sd(fb21$nerd, na.rm = T) #Stichproben SD (Populationsschätzer)
mean_Popu_nerd <- 2.9 #MW der Grundgesamtheit
d2 <- abs((mean_nerd - mean_Popu_nerd)/sd_nerd) #abs(), da Betrag
d2
```

Die Effektgröße ist mit `r round(d2, digits = 2)` als klein bis mittel einzuordnen.

</details>



**4.3** Sind die Psychologie-Studierenden (1. Semester) verträglicher (`vertr`) als die Grundgesamtheit ($\mu$ = 3.9)? Bestimmen Sie das 95%ige Konfidenzintervall und die Effektgröße.

<details><summary>Lösung</summary>

**Hypothesengenerierung:**

$\alpha$ = .05 

$H_0$: Die durchschnittlichen Verträglichkeitswerte der Psychologie-Studierenden $\mu_1$ sind geringer oder gleich gross wie die Werte der Gesamtbevölkerung $\mu_0$.

$H_0$: $\mu_0$ $\geq$ $\mu_1$

$H_1$: Die durchschnittlichen Verträglichkeitswerte der Psychologie-Studierenden $\mu_1$ sind größer als die Werte der Gesamtbevölkerung $\mu_0$.

$H_1$: $\mu_0$ $<$ $\mu_1$

```{r}
t.test(fb21$vertr, mu=3.9, alternative = "greater")
```

```{r, echo = FALSE}
t.test3 <- t.test(fb21$vertr, mu=3.9, alternative = "greater")
conf.int3 <- t.test3$conf.int
```

Mit einer Irrtumswahrscheinlichkeit von 5% kann die $H_0$ verworfen und die $H_1$ angenommen werden. Die Psychologie-Studierenden haben höhere Verträglichkeitswerte im Vergleich zur Gesamtbevölkerung.
Das 95%-ige Konfidenzintervall liegt zwischen `r round(conf.int3[1], digits = 2)` und $\infty$ (außerhalb des definierten Wertebereichs). Das bedeutet, dass in 95% der Fälle in einer wiederholten Ziehung aus der Grundgesamtheit die mittleren Verträglichkeitswerte zwischen `r round(conf.int3[1], digits = 2)` und $\infty$ (außerhalb des definierten Wertebereichs) liegen.

**Effektgröße:**

```{r}
mean_vertr <- mean(fb21$vertr, na.rm = T) #MW der Stichprobe
sd_vertr <- sd(fb21$vertr, na.rm = T) #Stichproben SD (Populationsschätzer)
mean_Popu_vertr <- 3.9 #MW der Grundgesamtheit
d3 <- abs((mean_vertr - mean_Popu_vertr)/sd_vertr) #abs(), da Betrag
d3
```

Die Effektgröße ist mit `r round(d3, digits = 2)` als mittel einzuordnen.

</details>
