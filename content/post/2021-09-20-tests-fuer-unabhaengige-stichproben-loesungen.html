---
title: Tests für unabhängige Stichproben - Lösungen
date: '2020-12-17'
slug: gruppenvergleiche-unabhaengig-loesungen
categories:
  - BSc2
tags:
  - t-Test
subtitle: ''
summary: ''
authors: [koehler, buchholz]
lastmod: '2021-12-22T13:15:14+01:00'
featured: no
header:
  image: "/header/BSc2_test_unabh_stpr.jpg"
  caption: "[Courtesy of pxhere](https://pxhere.com/en/photo/662606)"
projects: []
expiryDate: '2022-09-15'
publishDate: '2022-01-14'
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p><strong>Daten einlesen</strong></p>
<pre class="r"><code>setwd(&quot;...&quot;)  
load(&quot;fb21.rda&quot;)</code></pre>
<p><strong>Daten aufbereiten</strong></p>
<p>Prüfe zunächst, ob die Variablen Faktoren sind.</p>
<pre class="r"><code>is.factor(fb21$fach)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>is.factor(fb21$ort)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>is.factor(fb21$geschl)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>Falls nicht:</p>
<pre class="r"><code># Lieblingsfach als Faktor - falls es noch keiner war
fb21$fach &lt;- factor(fb21$fach, 
                    levels = 1:5,
                    labels = c(&#39;Allgemeine&#39;, &#39;Biologische&#39;, &#39;Entwicklung&#39;,
                               &#39;Klinische&#39;, &#39;Diag./Meth.&#39;))

# Wohnort als Faktor - falls es noch keiner war
fb21$ort &lt;- factor(fb21$ort, 
                   levels = c(1, 2),
                   labels = c(&#39;Frankfurt&#39;, &#39;anderer&#39;))


# Geschlecht als Faktor - falls es noch keiner war
fb21$geschl &lt;- factor(fb21$geschl, 
                      levels=c(1,2,3), 
                      labels=c(&#39;weiblich&#39;, &#39;maennlich&#39;, &#39;anderes&#39;))</code></pre>
<hr />
<div id="aufgabe-1" class="section level2">
<h2>Aufgabe 1</h2>
<p>Unterscheiden sich Studierende, die sich für Allgemeine Psychologie (Variable “fach”) interessieren, im Persönlichkeitsmerkmal Intellekt (auch: Offenheit für neue Erfahrungen, “intel”) von Studierenden, die sich für Klinische Psychologie interessieren? Normalverteilung des Merkmals in der Population darf angenommen werden.</p>
<details>
<summary>
Lösung
</summary>
<p><strong>Deskriptivstatistische Beantwortung der Fragestellung: grafisch</strong></p>
<pre class="r"><code>data1 &lt;- fb21[ (which(fb21$fach==&quot;Allgemeine&quot;|fb21$fach==&quot;Klinische&quot;)), ]
data1$fach &lt;- droplevels(data1$fach)
boxplot(data1$intel ~ data1$fach,
        xlab=&quot;Interessenfach&quot;, ylab=&quot;Intellekt&quot;, 
        las=1, cex.lab=1.5, 
        main=&quot;Interessenfach und Intellekt&quot;)</code></pre>
<p><img src="/post/2021-09-20-tests-fuer-unabhaengige-stichproben-loesungen_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><strong>Deskriptivstatistische Beantwortung der Fragestellung: statistisch</strong></p>
<pre class="r"><code># Überblick

library(psych)
describeBy(data1$intel, data1$fach)</code></pre>
<pre><code>## 
##  Descriptive statistics by group 
## group: Allgemeine
##    vars  n mean   sd median trimmed  mad  min max range  skew kurtosis   se
## X1    1 21 3.87 0.67      4     3.9 0.74 2.25   5  2.75 -0.41    -0.34 0.15
## ------------------------------------------------------------ 
## group: Klinische
##    vars  n mean   sd median trimmed  mad min  max range  skew kurtosis   se
## X1    1 44 3.56 0.61   3.62    3.58 0.56   2 4.75  2.75 -0.45    -0.31 0.09</code></pre>
<pre class="r"><code># Berechnung der empirischen Standardabweichung

intel.A &lt;- data1$intel[(data1$fach==&quot;Allgemeine&quot;)]
sigma.A &lt;- sd(intel.A)
n.A &lt;- length(intel.A[!is.na(intel.A)])
sd.A &lt;- sigma.A * sqrt((n.A-1) / n.A)
sd.A </code></pre>
<pre><code>## [1] 0.657462</code></pre>
<pre class="r"><code>intel.B &lt;- data1$intel[(data1$fach==&quot;Klinische&quot;)]
sigma.B &lt;- sd(intel.B)
n.B &lt;- length(intel.B[!is.na(intel.B)])
sd.B &lt;- sigma.B * sqrt((n.B-1) / n.B)
sd.B</code></pre>
<pre><code>## [1] 0.6050536</code></pre>
<p>Mittelwert der Allgemeinen Psychologen (<em>M</em> = 3.87, <em>SD</em> = 0.66) unterscheidet sich deskriptivstatistisch vom Mittelwert der Klinischen (<em>M</em> = 3.56, <em>SD</em> = 0.61).</p>
<p><strong>Voraussetzungsprüfung: Normalverteilung</strong></p>
<pre class="r"><code>par(mfrow=c(1,2))
intel.A &lt;- data1[which(data1$fach==&quot;Allgemeine&quot;), &quot;intel&quot;]
hist(intel.A, xlim=c(1,6), main=&quot;Intellekt (Allgemeine Psy.)&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, prob=T)
curve(dnorm(x, mean=mean(intel.A, na.rm=T), sd=sd(intel.A, na.rm=T)), col=&quot;blue&quot;, lwd=2, add=T)
qqnorm(intel.A)
qqline(intel.A, col=&quot;blue&quot;)</code></pre>
<p><img src="/post/2021-09-20-tests-fuer-unabhaengige-stichproben-loesungen_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><span class="math inline">\(\rightarrow\)</span> Entscheidung: Normalverteilung wird für Gruppe 1 (Allgemeine Psycholgie) angenommen</p>
<pre class="r"><code>par(mfrow=c(1,2))
intel.B &lt;- data1[which(data1$fach==&quot;Klinische&quot;), &quot;intel&quot;]
hist(intel.B, xlim=c(1,6), main=&quot;Intellekt (Klinische Psy.)&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, prob=T)
curve(dnorm(x, mean=mean(intel.B, na.rm=T), sd=sd(intel.B, na.rm=T)), col=&quot;blue&quot;, lwd=2, add=T)
qqnorm(intel.B)
qqline(intel.B, col=&quot;blue&quot;)</code></pre>
<p><img src="/post/2021-09-20-tests-fuer-unabhaengige-stichproben-loesungen_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><span class="math inline">\(\rightarrow\)</span> Entscheidung: Normalverteilung wird für Gruppe 2 (Klinische Psycholgie) angenommen</p>
<p><strong>Hypothesen</strong></p>
<ul>
<li>Art des Effekts: Unterschiedshypothese<br />
</li>
<li>Richtung des Effekts: Ungerichtet <span class="math inline">\(\rightarrow\)</span> ungerichtete Hypothesen<br />
</li>
<li>Größe des Effekts: Unspezifisch</li>
</ul>
<p>Hypthesenpaar (statistisch):</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_\text{Allgemeine} = \mu_\text{Klinische}\)</span></li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\mu_\text{Allgemeine} \ne \mu_\text{Klinische}\)</span></li>
</ul>
<p><strong>Spezifikation des Signifikanzniveaus</strong></p>
<p><span class="math inline">\(\alpha = .05\)</span></p>
<p><strong>Voraussetzungsprüfung: Varianzhomogenität</strong></p>
<pre class="r"><code>library(car)
leveneTest(data1$intel ~ data1$fach)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  1  0.0498 0.8242
##       63</code></pre>
<pre class="r"><code>levene &lt;- leveneTest(data1$intel ~ data1$fach)
f &lt;- round(levene$`F value`[1], 2)
p &lt;- round(levene$`Pr(&gt;F)`[1], 3)</code></pre>
<p><em>F</em>(1, 63) = 0.05, <em>p</em> = 0.824 <span class="math inline">\(\rightarrow\)</span> Das Ergebnis ist nicht signifikant, die <span class="math inline">\(H_0\)</span> wird beibehalten und Varianzhomogenität angenommen.</p>
<p><strong>Durchführung des <em>t</em>-Tests</strong></p>
<pre class="r"><code>t.test(data1$intel ~ data1$fach,           # abhängige Variable ~ unabhängige Variable
       paired = F,                   # Stichproben sind unabhängig 
       alternative = &quot;two.sided&quot;,         # zweiseitige Testung
       var.equal = T,                # Varianzhomogenität ist gegeben (-&gt; Levene-Test)
       conf.level = .95)             # alpha = .05 </code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  data1$intel by data1$fach
## t = 1.8619, df = 63, p-value = 0.06729
## alternative hypothesis: true difference in means between group Allgemeine and group Klinische is not equal to 0
## 95 percent confidence interval:
##  -0.0228855  0.6473444
## sample estimates:
## mean in group Allgemeine  mean in group Klinische 
##                 3.869048                 3.556818</code></pre>
<p><strong>Formales Berichten des Ergebnisses</strong></p>
<p>Es wurde untersucht, ob sich Studierende, die sich für Allgemeine Psychologie interessieren, im Persönlichkeitsmerkmal ‘Intellekt’ (auch: Offenheit für neue Erfahrungen) von Studierenden, die sich für Klinische Psychologie interessieren, unterscheiden. Deskriptiv liegt ein solcher Unterschied vor: Die Mittelwerte betragen 3.87 (Allgemeine, <em>SD</em> = 0.66) und 3.56 (Klinische, <em>SD</em> = 0.61). Der entsprechende <em>t</em>-Test zeigt jedoch ein nicht signifikantes Ergebnis (<em>t</em>(<em>df</em> = 63, zweis.) = 1.86, <em>p</em> = 0.067). Die Nullhypothese konnte nicht verworfen werden und wird beibehalten. Die Studierenden sind im Persönlichkeitsmerkmal ‘Intellekt’ unabhängig davon, ob sie sich für Allgemeine Psychologie oder für Klinische Psychologie interessieren.</p>
</details>
</div>
<div id="aufgabe-2" class="section level2">
<h2>Aufgabe 2</h2>
<p>Sind Studierende, die außerhalb von Frankfurt wohnen (“ort”), zufriedener im Leben (“lz”) als diejenigen, die innerhalb von Frankfurt wohnen?</p>
<details>
<summary>
Lösung
</summary>
<p><strong>Deskriptivstatistische Beantwortung der Fragestellung: grafisch</strong></p>
<pre class="r"><code>boxplot(fb21$lz ~ fb21$ort,
        xlab=&quot;Wohnort&quot;, ylab=&quot;Lebenszufriedenheit&quot;, 
        las=1, cex.lab=1.5, 
        main=&quot;Wohnort und Lebenszufriedenheit&quot;)</code></pre>
<p><img src="/post/2021-09-20-tests-fuer-unabhaengige-stichproben-loesungen_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><strong>Deskriptivstatistische Beantwortung der Fragestellung: statistisch</strong></p>
<pre class="r"><code>library(psych)
describeBy(fb21$lz, fb21$ort)</code></pre>
<pre><code>## 
##  Descriptive statistics by group 
## group: Frankfurt
##    vars  n mean   sd median trimmed  mad min max range skew kurtosis   se
## X1    1 55 4.97 1.25      5    5.04 1.48   2   7     5 -0.4    -0.67 0.17
## ------------------------------------------------------------ 
## group: anderer
##    vars  n mean   sd median trimmed  mad min max range  skew kurtosis   se
## X1    1 55    5 1.03    5.2    5.06 0.89 1.6   7   5.4 -0.72     0.99 0.14</code></pre>
<pre class="r"><code>summary(fb21[which(fb21$ort==&quot;Frankfurt&quot;), &quot;lz&quot;])</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   2.000   4.000   5.000   4.971   5.800   7.000       1</code></pre>
<pre class="r"><code>summary(fb21[which(fb21$ort==&quot;anderer&quot;), &quot;lz&quot;])</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   1.600   4.600   5.200   5.004   5.600   7.000       1</code></pre>
<p>Mittelwert der Nicht-Frankfurter:innen ist deskriptiv höher als der der Frankfurter:innen.</p>
<p><strong>Voraussetzungsprüfung: Normalverteilung</strong></p>
<pre class="r"><code>par(mfrow=c(1,2))
lz.F &lt;- fb21[which(fb21$ort==&quot;Frankfurt&quot;), &quot;lz&quot;]
hist(lz.F, xlim=c(1,9), ylim=c(0,.35), main=&quot;Lebenzufriedenheit\n(Frankfurter)&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, prob=T)
curve(dnorm(x, mean=mean(lz.F, na.rm=T), sd=sd(lz.F, na.rm=T)), col=&quot;red&quot;, lwd=2, add=T)
qqnorm(lz.F)
qqline(lz.F, col=&quot;red&quot;)</code></pre>
<p><img src="/post/2021-09-20-tests-fuer-unabhaengige-stichproben-loesungen_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> Entscheidung: Normalverteilung wird angenommmen</p>
<pre class="r"><code>par(mfrow=c(1,2))
lz.a &lt;- fb21[which(fb21$ort==&quot;anderer&quot;), &quot;lz&quot;]
hist(lz.a, xlim=c(1,9), main=&quot;Lebenszufriedenheit\n(Nicht-Frankfurter)&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, prob=T)
curve(dnorm(x, mean=mean(lz.a, na.rm=T), sd=sd(lz.a, na.rm=T)), col=&quot;red&quot;, lwd=2, add=T)
qqnorm(lz.a)
qqline(lz.a, col=&quot;red&quot;)</code></pre>
<p><img src="/post/2021-09-20-tests-fuer-unabhaengige-stichproben-loesungen_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> Entscheidung: Normalverteilung wird nicht angenommmen</p>
<p><strong>Hypothesen</strong></p>
<ul>
<li>Art des Effekts: Unterschiedshypothese<br />
</li>
<li>Richtung des Effekts: Gerichtet <span class="math inline">\(\rightarrow\)</span> gerichtete Hypothesen<br />
</li>
<li>Größe des Effekts: Unspezifisch</li>
</ul>
<p>Hypthesenpaar (statistisch):</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\eta_\text{Frankfurter} \ge \eta_\text{nicht-Frankfurter}\)</span><br />
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\eta_\text{Frankfurter} &lt; \eta_\text{nicht-Frankfurter}\)</span></li>
</ul>
<p><strong>Spezifikation des Signifikanzniveaus</strong></p>
<p><span class="math inline">\(\alpha = .05\)</span></p>
<p><strong>Durchführung des Wilcoxon-Tests</strong></p>
<pre class="r"><code>wilcox.test(fb21$lz ~ fb21$ort,           # abhängige Variable ~ unabhängige Variable
       paired = F,                   # Stichproben sind unabhängig 
       alternative = &quot;less&quot;,         # einseitige Testung: Gruppe1 (Frankfurter:innen) &lt; Gruppe2 (Nicht-Frankfurter:innen) 
       conf.level = .95)             # alpha = .05 </code></pre>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  fb21$lz by fb21$ort
## W = 1512.5, p-value = 0.5012
## alternative hypothesis: true location shift is less than 0</code></pre>
<p><strong>Formales Berichten des Ergebnisses</strong></p>
<p>Es wurde untersucht, ob außerhalb von Frankfurt wohnende Studierende zufriedener im Leben sind als die in Frankfurt wohnenden. Deskriptiv zeigt sich tatsächlich, dass die Nicht-Frankfurter:innen zufriedener sind (<em>Mdn</em> = 5.2, <em>IQB</em> = [4.6 ; 5.6]) als die Frankfurter:innen (<em>Mdn</em> = 5, <em>IQB</em> = [4 ; 5.8]). entsprechende Wilcoxon-Test zeigt jedoch ein nicht signifikantes Ergebnis (<em>W</em> = <code>round(wilcox$statistic, 1)</code>, <em>p</em> = 0.501). Die Nullhypothese konnte nicht verworfen werden und wird beibehalten. Die Studierenden sind gleich zufrieden, unabhängig von ihrem Wohnort.</p>
</details>
</div>
<div id="aufgabe-3" class="section level2">
<h2>Aufgabe 3</h2>
<p>Ist die Wahrscheinlichkeit dafür, innerhalb von Frankfurt zu wohnen, die gleiche für weibliche wie für männliche Erstsemester-Studierende der Psychologie?</p>
<details>
<summary>
Lösung
</summary>
<p>Beide Variablen sind nominalskaliert <span class="math inline">\(\rightarrow \chi^2\)</span>-Test</p>
<p><strong>Voraussetzungen</strong></p>
<ol style="list-style-type: decimal">
<li>Die einzelnen Beobachtungen sind voneinander unabhängig <span class="math inline">\(\rightarrow\)</span> ok</li>
<li>Jede Person lässt sich eindeutig einer Kategorie bzw. Merkmalskombination zuordnen <span class="math inline">\(\rightarrow\)</span> ok</li>
<li>Zellbesetzung für alle <span class="math inline">\(n_{ij}\)</span> &gt; 5 <span class="math inline">\(\rightarrow\)</span> Prüfung anhand von Häufigkeitstabelle</li>
</ol>
<pre class="r"><code>fb21$geschlecht &lt;- fb21$geschl
fb21$geschlecht[fb21$geschlecht==&quot;anderes&quot;] &lt;- NA #Umkodieren von &quot;anderes&quot; in fehlenden Wert
fb21$geschlecht &lt;- droplevels(fb21$geschlecht) #Level &quot;anderes&quot; wird eliminiert
tab &lt;- table(fb21$geschlecht, fb21$ort)
tab</code></pre>
<pre><code>##            
##             Frankfurt anderer
##   weiblich         42      38
##   maennlich        14      17</code></pre>
<p><span class="math inline">\(\rightarrow n_{ij}\)</span> &gt; 5 in allen Zellen gegeben</p>
<p><strong>Hypothesen</strong></p>
<ul>
<li>Art des Effekts: Zusammenhangshypothese</li>
<li>Richtung des Effekts: Ungerichtet</li>
<li>Größe des Effekts: Unspezifisch</li>
</ul>
<p>Hyothesenpaar (inhaltlich):</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: Weibliche und männliche Studierende der Psychologie wohnen mit gleicher Wahrscheinlichkeit innerhalb bzw. außerhalb von Frankfurt.<br />
</li>
<li><span class="math inline">\(H_1\)</span>: Weibliche und männliche Studierende der Psychologie unterscheiden sich in der Wahrscheinlichkeit, innerhalb bzw. außerhalb von Frankfurt zu wohnen.</li>
</ul>
<p>Hypothesenpaar (statistisch):</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\pi_{ij} = \pi_{i\bullet} \cdot \pi_{\bullet j}\)</span><br />
</li>
<li><span class="math inline">\(H_1\)</span>: <span class="math inline">\(\pi_{ij} \neq \pi_{i\bullet} \cdot \pi_{\bullet j}\)</span></li>
</ul>
<p><strong>Durchführung des <span class="math inline">\(\chi^2\)</span>-Test in R</strong></p>
<pre class="r"><code>chisq.test(tab, correct=FALSE)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tab
## X-squared = 0.48135, df = 1, p-value = 0.4878</code></pre>
<p><span class="math inline">\(\chi^2\)</span> = 0.481, df = 1, p = 0.488 <span class="math inline">\(\rightarrow H_0\)</span></p>
<p><strong>Effektstärke Phi (<span class="math inline">\(\phi\)</span>)</strong></p>
<pre class="r"><code>library(psych)
phi(tab)</code></pre>
<pre><code>## [1] 0.07</code></pre>
<p><strong>Ergebnisinterpretation</strong></p>
<p>Es wurde untersucht, ob sich männliche und weibliche Studierende in ihrem Wohnort (Frankfurt vs. außerhalb) unterscheiden. Zur Beantwortung der Fragestellung wurde ein Vierfelder-Chi-Quadrat-Test für unabhängige Stichproben berechnet. Der Zusammenhang zwischen Wohnort und Geschlecht ist nicht signifikant (<span class="math inline">\(\chi^2\)</span>(1) = 0.481, <em>p</em> = 0.488), somit wird die Nullhypothese beibehalten. Der Effekt ist von vernachlässigbarer Stärke (<span class="math inline">\(\phi\)</span> = 0.07). Männliche und weibliche Studierende wohnen also mit gleicher Wahrscheinlichkeit in Frankfurt bzw. außerhalb von Frankfurt.</p>
</details>
</div>
