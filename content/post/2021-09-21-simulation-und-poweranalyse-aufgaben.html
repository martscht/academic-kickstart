---
title: Simulation und Poweranalyse - Aufgaben
author: 
date: '2021-09-21'
slug: simulation-aufg
categories:
  - BSc2
  - Aufgaben
tags:
  - Simulation
  - Poweranalyse
subtitle: ''
summary: ''
authors: [irmer]
lastmod: '2021-12-15T13:13:57+01:00'
featured: no
header:
  image: "/header/BSc2_Sim_Power.jpg"
  caption: "[Courtesy of pxhere](https://pxhere.com/en/photo/674621)"
projects: []
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="aufgabe-1" class="section level2">
<h2>Aufgabe 1</h2>
<div id="lineare-beziehungen-zwischen-variablen-korrelationstest-unter-h_1" class="section level3">
<h3>Lineare Beziehungen zwischen Variablen: Korrelationstest unter <span class="math inline">\(H_1\)</span></h3>
<p>Wir wollen uns ebenfalls die Power für den Korrelationstest ansehen. Dazu müssen wir allerdings korrelierte Variablen generieren. Um das hinzubekommen, müssen wir einige Eigenschaften der Normalverteilung ausnutzen: bspw. dass die Summe zweier normalverteilter Zufallsvariablen wieder normalverteilt ist. Für zwei unabhängige (unkorrelierte) standard-normalverteilte Zufallsvariablen <span class="math inline">\(X\)</span> und <span class="math inline">\(Z\)</span>, ist die Zufallsvariable <span class="math inline">\(Y\)</span>, die folgendermaßen gebildet wird</p>
<p><span class="math display">\[Y:= \rho X + \sqrt{1-\rho^2}Z,\]</span>
wieder standard-normalverteilt und um den Korrelationskoeffizienten <span class="math inline">\(\rho\)</span> korreliert mit <span class="math inline">\(X\)</span>. Wir können also relativ einfach zwei korrelierte Variablen generieren. Wie in der Sitzung verwenden wir <span class="math inline">\(N=20\)</span>:</p>
<pre class="r"><code>N &lt;- 20

set.seed(12345)
X &lt;- rnorm(N)
Z &lt;- rnorm(N)
Y &lt;- 0.5*X + sqrt(1 - 0.5^2)*Z
cor(X, Y) # empirische Korrelation</code></pre>
<pre><code>## [1] 0.579799</code></pre>
<pre class="r"><code>sd(X) </code></pre>
<pre><code>## [1] 0.8339354</code></pre>
<pre class="r"><code>sd(Y)</code></pre>
<pre><code>## [1] 1.232089</code></pre>
<p>Falls Sie die oben genutzte Formel zur Generierung korrelierter Zufallsvariablen überprüfen wollen, dann setzen Sie doch einmal <code>N = 10^6</code> (also eine Stichprobe von 1 Mio). Dann sollte die empirische Korrelation sehr nah an der theoretischen liegen. Auch sollten dann die empirischen Standardabweichungen sehr nah an der 1 liegen.</p>
<p>Verwenden Sie für diese Aufgabe stets den Seed 12345 (<code>set.seed(12345)</code>).</p>
<ul>
<li>Betrachten Sie das Modell für eine Stichprobe von <code>N = 10^6</code>. Berichten Sie die empirische Korrelation sowie die empirischen Standardabweichungen.</li>
<li>Untersuchen Sie die Power des Korrelationstests für eine Korrelation von <span class="math inline">\(\rho=0.5\)</span> und <span class="math inline">\(N = 20\)</span>. Führen Sie eine Simulationsstudie durch. Wie groß ist die Power?</li>
<li>Stellen Sie die Verteilung der empirischen Korrelationen (für <span class="math inline">\(\rho=0.5\)</span> und <span class="math inline">\(N=20\)</span>) unter der <span class="math inline">\(H_1\)</span> dar.</li>
</ul>
</div>
</div>
<div id="aufgabe-2" class="section level2">
<h2>Aufgabe 2</h2>
<div id="lineare-beziehungen-zwischen-variablen-korrelationstest-unter-h_1-für-ungleiche-varianzen" class="section level3">
<h3>Lineare Beziehungen zwischen Variablen: Korrelationstest unter <span class="math inline">\(H_1\)</span> für ungleiche Varianzen</h3>
<p>Wiederholen Sie die Analyse. Verändern Sie diesmal die Varianz der beiden Variablen <code>X</code>und <code>Y</code>. <code>X</code> soll eine Varianz von 9 haben (multiplizieren Sie dazu <code>X</code> mit 3, nachdem Sie <code>Y</code> mit Hilfe von <code>X</code> und <code>Z</code> generiert haben), und <code>Y</code> soll eine Varianz von 0.25 haben (multiplizieren Sie dazu <code>Y</code> mit 0.5, nachdem Sie <code>Y</code> mit Hilfe von <code>X</code> und <code>Z</code> generiert haben).</p>
<ul>
<li>Betrachten Sie das Modell für eine Stichprobe von <code>N = 10^6</code>. Berichten Sie die empirische Korrelation sowie die empirischen Standardabweichungen.</li>
<li>Führen Sie eine Simulationsstudie durch (für <span class="math inline">\(\rho=0.5\)</span> und <span class="math inline">\(N=20\)</span>). Wie verändert sich die Power des Tests durch die veränderten Varianzen?</li>
</ul>
</div>
</div>
<div id="aufgabe-3" class="section level2">
<h2>Aufgabe 3</h2>
<div id="type-i-error-und-power-zu-einem-alpha-niveau-von-0.1-des-t-test" class="section level3">
<h3>Type I-Error und Power zu einem <span class="math inline">\(\alpha\)</span>-Niveau von <span class="math inline">\(0.1\%\)</span> des <span class="math inline">\(t\)</span>-Test</h3>
<p>Wir wollen nun die die Power des <span class="math inline">\(t\)</span>-Tests für ein anderes <span class="math inline">\(\alpha\)</span>-Fehlerniveau bestimmen. Wiederholen Sie also die Poweranalysen aus der Sitzung für den <span class="math inline">\(\alpha\)</span>-Fehler und die Power für ein <span class="math inline">\(\alpha\)</span>-Fehlerniveau von <span class="math inline">\(0.1\%\)</span>.</p>
<p>Nutzen Sie den Seed 12345 (<code>set.seed(12345)</code>).</p>
<ul>
<li>Führen Sie eine Simulation durch, um das empirische <span class="math inline">\(\alpha\)</span>-Niveau des <span class="math inline">\(t\)</span>-Tests zu bestimmen für <span class="math inline">\(N=20\)</span>. Vergleichen Sie das Ergebnis mit dem Ergebnis aus der Sitzung.</li>
<li>Führen Sie eine Simulation durch, um die empirische Power des <span class="math inline">\(t\)</span>-Tests zu bestimmen für <span class="math inline">\(N=20\)</span>, <span class="math inline">\(d = 0.5\)</span> und <span class="math inline">\(\alpha = 0.1\%\)</span>. Vergleichen Sie das Ergebnis mit dem Ergebnis aus der Sitzung. Was bedeutet dies für die Wahl der Irrtumswahrscheinlichkeit?</li>
</ul>
</div>
</div>
<div id="aufgabe-4" class="section level2">
<h2>Aufgabe 4</h2>
<div id="power-plots-für-den-t-test" class="section level3">
<h3>Power-Plots für den <span class="math inline">\(t\)</span>-Test</h3>
<p>Wir wollen nun die Power des <span class="math inline">\(t\)</span>-Tests für unterschiedliche Effektgrößen untersuchen. In den beiden Gruppen soll jeweils eine Varianz von 1 herrschen. Verändern Sie also den Code der Sitzung nur hinsichtlich der Effektgröße. Das <span class="math inline">\(\alpha\)</span>-Fehlerniveau soll wieder bei <span class="math inline">\(5\%\)</span> liegen.</p>
<p>Nutzen Sie den Seed 12345 (<code>set.seed(12345)</code>).</p>
<ul>
<li>Erstellen Sie einen Power-Plot für die folgenden Effekte <span class="math inline">\(d = 0, 0.25, 0.5, 0.75, 1,\)</span> und <span class="math inline">\(1.25\)</span> bei einer Stichprobengröße von <span class="math inline">\(N = 20\)</span>. Stellen Sie die Effektgröße auf der x-Achse dar.</li>
</ul>
</div>
</div>
<div id="aufgabe-5" class="section level2">
<h2>Aufgabe 5</h2>
<div id="powervergleich-t-test-vs.-wilcoxon-test" class="section level3">
<h3>Powervergleich: <span class="math inline">\(t\)</span>-Test vs. Wilcoxon-Test</h3>
<p>Wir wollen nun die Power des <span class="math inline">\(t\)</span>-Tests mit der Power des Wilcoxon-Test vergleichen. Der Wilcoxon-Test ist flexibler anzuwenden, da er weniger Annahmen aufweist. Untersuchen Sie, wie sich dies auf die Power auswirkt. Das <span class="math inline">\(\alpha\)</span>-Fehlerniveau soll wieder bei <span class="math inline">\(5\%\)</span> liegen.</p>
<p>Nutzen Sie den Seed 12345 (<code>set.seed(12345)</code>).</p>
<ul>
<li>Verwenden Sie das gleiche Setting wie aus der Sitzung und bestimmen Sie die Power des Wilcoxon-Tests für <span class="math inline">\(N=20\)</span>, <span class="math inline">\(d = 0.5\)</span> und <span class="math inline">\(\alpha = 5\%\)</span>. Vergleichen Sie das Ergebnis mit dem Ergebnis aus der Sitzung.</li>
</ul>
</div>
</div>
