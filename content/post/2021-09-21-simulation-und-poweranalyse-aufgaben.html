---
title: Simulation und Poweranalyse - Aufgaben
author: 
date: '2021-09-21'
slug: simulation-aufg
categories:
  - BSc2
  - Aufgaben
tags:
  - Simulation
  - Poweranalyse
subtitle: ''
summary: ''
authors: [irmer]
lastmod: '2021-01-04T13:13:57+01:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="aufgabe-1" class="section level2">
<h2>Aufgabe 1</h2>
<div id="lineare-beziehungen-zwischen-variablen-korrelationstest-unter-h_1" class="section level3">
<h3>Lineare Beziehungen zwischen Variablen: Korrelationstest unter <span class="math inline">\(H_1\)</span></h3>
<p>Wir wollen uns ebenfalls die Power für den Korrelationstest ansehen. Dazu müssen wir allerdings korrelierte Variablen generieren. Um das hinzubekommen, müssen wir einige Eigenschaften der Normalverteilung ausnutzen: bspw. dass die Summe zweier normalverteilter Zufallsvariablen wieder normalverteilt ist. Für zwei unabhängige (unkorrelierte) standard-normalverteilte Zufallsvariablen <span class="math inline">\(X\)</span> und <span class="math inline">\(Z\)</span>, ist die Zufallsvariable <span class="math inline">\(Y\)</span>, die folgendermaßen gebildet wird</p>
<p><span class="math display">\[Y:= \rho X + \sqrt{1-\rho^2}Z,\]</span>
wieder standard-normalverteilt und um den Korrelationskoeffizienten <span class="math inline">\(\rho\)</span> korreliert mit <span class="math inline">\(X\)</span>. Wir können also relativ einfach zwei korrelierte Variablen generieren. Wie in der Sitzung verwenden wir <span class="math inline">\(N=20\)</span>:</p>
<pre class="r"><code>N &lt;- 20

set.seed(12345)
X &lt;- rnorm(N)
Z &lt;- rnorm(N)
Y &lt;- 0.5*X + sqrt(1 - 0.5^2)*Z
cor(X, Y) # empirische Korrelation</code></pre>
<pre><code>## [1] 0.579799</code></pre>
<pre class="r"><code>sd(X) </code></pre>
<pre><code>## [1] 0.8339354</code></pre>
<pre class="r"><code>sd(Y)</code></pre>
<pre><code>## [1] 1.232089</code></pre>
<p>Verwenden Sie für diese Aufgabe stets den Seed 12345 (<code>set.seed(12345)</code>).</p>
<ul>
<li>Untersuchen Sie die Power des Korrelationstests für eine Korrelation von <span class="math inline">\(\rho=0.5\)</span> und <span class="math inline">\(N = 20\)</span>. Führen Sie eine Simulationsstudie durch. Wie groß ist die Power?</li>
<li>Stellen Sie die Verteilung der empirische <span class="math inline">\(t\)</span>-Werte dieses Tests (für <span class="math inline">\(\rho=0.5\)</span> und <span class="math inline">\(N=20\)</span>) unter der <span class="math inline">\(H_1\)</span> dar.</li>
<li>Wiederholen Sie die Analyse. Verändern Sie diesmal die Varianz der beiden Variablen <code>X</code>und <code>Y</code>. <code>X</code> soll eine Varianz von 9 haben (multiplizieren Sie dazu <code>X</code> mit 3, nachdem Sie <code>Y</code> mit Hilfe von <code>X</code> und <code>Z</code> generiert haben), und <code>Y</code> soll eine Varianz von 0.25 haben (multiplizieren Sie dazu <code>Y</code> mit 0.5, nachdem Sie <code>Y</code> mit Hilfe von <code>X</code> und <code>Z</code> generiert haben). Führen Sie eine Simulationsstudie durch (für <span class="math inline">\(\rho=0.5\)</span> und <span class="math inline">\(N=20\)</span>). Wie verändert sich die Power des Tests durch die veränderten Varianzen?</li>
</ul>
</div>
</div>
<div id="aufgabe-2" class="section level2">
<h2>Aufgabe 2</h2>
<div id="power-plots" class="section level3">
<h3>Power-Plots</h3>
<p>Um dieser Frage nachzugehen, untersuchen wir die Power, für einige Effektgrößen für <span class="math inline">\(N=20\)</span>. Hierzu haben wir bereits zwei Analysen durchgeführt, nämlich einmal mit <span class="math inline">\(d=0.5\)</span> und einmal mit <span class="math inline">\(d=0\)</span> (als wir den <span class="math inline">\(\alpha\)</span>-Fehler unter <span class="math inline">\(H_0\)</span> untersucht haben):</p>
<p><img src="/post/2021-09-21-simulation-und-poweranalyse-aufgaben_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Diesem Plot ist nun zu entnehmen, dass eine Mittelwertsdifferenz von größer 0.8 nötig ist, damit die Power hinreichend groß ist. Außerdem wird in diesem Plot auch ersichtlich, dass wenn die Mittelwertsdifferenz 0 ist, dann sind wir gerade im Fall der <span class="math inline">\(H_0\)</span> gelandet. Die Power sollte hier dann nur bei <span class="math inline">\(5\%\)</span> liegen. Falls wir negative Mittelwertsdifferenzen gewählt hätten, dann wäre der Plot identisch, nur an der x-Achse gespiegelt. Natürlich können Informationen zur Effektstärke sowie zur Stichprobengröße gemeinsam in eine Grafik eingefügt werden.</p>
</div>
</div>
