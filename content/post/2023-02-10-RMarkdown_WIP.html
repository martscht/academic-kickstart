---
title: "RMarkdown"
date: '2023-02-10'
slug: RMarkdown
categories:
  - extras
tags:
subtitle: ''
summary: ''
authors: [pommeranz]
lastmod: '2023-04-11'
featured: no
header:
  image: "/header/" #https://pxhere.com/de/photo/29 maybe this?
  caption: "[Courtesy of pxhere](https://pxhere.com/de/photo/29)"
projects: []
---



<!--r blogdown::shortcode_open("detail_disclosure", "Kernfragen dieses Beitrags")-->
<!-- Die divs sind wichtig, damit die Liste funktioniert! Innerhalb dieses Shortcodes ist HTML erlaubt (safeHTML) -->
<div>
<ul>
<li>Was ist <a href="#RMarkdown"><strong>RMarkdown</strong></a>?</li>
<li>Wie <a href="#Erstellen"><strong>erstelle</strong></a> ich eine RMarkdown-Datei?</li>
<li>Wie hängen <a href="#Zusammenspiel"><strong>RMarkdown und Pandoc</strong></a> zusammen?</li>
<li>Wie ist eine Rmd <a href="#Aufbau"><strong>aufgebaut</strong></a>?</li>
<li>Was kann ein <a href="#Codechunk"><strong>Code Chunk</strong></a> besonders in RMarkdown?</li>
<li>Was macht den <a href="#Setup"><strong>Setup-Chunk</strong></a> besonders im Vergleich zu anderen Code Chunks?</li>
<li>Wie ist das <a href="#WD"><strong>Working Directory</strong></a> bei RMarkdown aufgebaut?</li>
<li>Wie kann ich meinen Code direkt <a href="#Inline"><strong>in meinen Text einbinden</strong></a>?</li>
</ul>
</div>
<!--r blogdown::shortcode_close("detail_disclosure")-->
<hr />
<div id="RMarkdown" class="section level2 anchorheader">
<h2>Was ist RMarkdown?</h2>
<p>RMarkdown ist ein Framework, welches es ermöglicht, die Arbeit mit Daten in der Programmiersprache R möglichst transparent darzustellen und in einem Dokument aufzubereiten.Der Nutzen dahinter liegt unter anderem in gut einsehbarer und reproduzierbarer Forschung, da man damit seinen Workflow erweitert erläutern und visualisieren kann. Mit hinterlegtem Quellcode können auch mögliche Fehler in der Datenaufbereitung und -verarbeitung transparent von außen einsehbar werden.</p>
</div>
<div id="Erstellen" class="section level2 anchorheader">
<h2>RMarkdown-Datei erstellen</h2>
<p>Um eine RMarkdown-Datei zu erstellen, muss man in RStudio oben links eine neue Datei erstellen, und dort RMarkdown auswählen. Nun sollte sich ein Fenster öffnen in dem man einige Angaben treffen kann. Die ersten drei Parameter sind dabei relativ selbsterklärend, der Titel des Markdown-Dokuments, das Datum der Erstellung sowie der Name der/des Autor*in des Dokuments. Das Output-Format hingegen bestimmt, in welcher Form das Dokument ausgegeben werden soll, PDF, Word oder Html. Diese Parameter lassen sich später aber noch anpassen.</p>
<!-- Hier Bild einfügen -->
</div>
<div id="Zusammenspiel" class="section level2 anchorheader">
<h2>RMarkdown und Pandoc</h2>
<p>Die RMarkdown-Datei wird mit dem Knit-Button, welcher in der Leiste unterhalb des Dateifensters ist, zu einem Dokument nach vordefiniertem Format kompiliert. Dabei wird zuerst der R-Code ausgeführt und dann in ein normales Markdown-Dokument kompiliert, dies ist die Funktion von “knitr”. Im Anschluss wird das Markdown-Dokument mit Pandoc zu einem fertigen Dokument im gewünschten Format kompiliert. Innerhalb dieses Ablaufs wird aus dem Rmd bspw. eine Homepage oder ein PDF.</p>
</div>
<div id="Aufbau" class="section level2 anchorheader">
<h2>Aufbau des Dokuments</h2>
<p>Eine RMarkdown-Datei enthält typischerweise einen <strong>Head</strong> und einen <strong>Textkörper</strong>, sowie <strong>Code-Chunks/Code-Blöcke</strong>.</p>
<p>Im Head des Dokuments befinden sich die Argumente die beim Erstellen übergeben wurden. Es gibt viele weitere Output-Möglichkeiten wie beispielsweise Powerpoint-Slides. Auf der <a href="https://rmarkdown.rstudio.com/lesson-9.html">Seite von RStudio</a> gibt es eine Liste weiterer Optionen.</p>
<p>Im eigentlichen Textkörper steht einfacher Text, wie er auch hier steht. Manchmal sind im Text <a href="">Links</a> gesetzt, oder auch <em>schiefgestellter</em> oder <strong>fettgedruckter</strong> Text, dies wird auch mit Markdown-Syntax umgesetzt.</p>
<p>Die Code Chunks sind das, was ein RMarkdown von einem “normalen” Markdown-Dokument unterscheidet. Mit ihnen lässt sich R-Code in ein Dokument einbauen und ausführen, womit man unter anderem Grafiken und Ergebnisse automatisch berechnen und darstellen lassen kann.</p>
<p>Wie diese Bestandteile im Detail funktionieren, wird im folgenden schrittweise aufgeklärt.</p>
</div>
<div id="Codechunk" class="section level2 anchorheader">
<h2>Code Chunks</h2>
<p>Mit Code Chunks, welche zuvor im Markdown-Tutorial rein visuell verwendet wurden, lässt sich R-Code in ein Dokument einbauen um Ergebnisse, Analysen und Grafiken dynamisch in einen Fließtext zu integrieren. Erstellt werden diese mit einem Codeblock und einem Zusatzargument, der die Programmiersprache des Blocks definiert.</p>
<pre><code>```{r }⠀
R-Code
```⠀</code></pre>
<p>Hier ein Beispiel basierend auf dem Fragebogendatensatz fb22.</p>
<pre class="r"><code>#Fragebogendaten aus PsyBsc2 laden
load(url(&#39;https://pandar.netlify.app/post/fb22.rda&#39;))

#prüfen, ob n &gt;= 30
length(na.omit(fb22$nerd[fb22$job==2])) #Student*innen mit Nebenjob</code></pre>
<pre><code>## [1] 52</code></pre>
<pre class="r"><code>length(na.omit(fb22$nerd[fb22$job==1])) #Student*innen ohne Nebenjob</code></pre>
<pre><code>## [1] 97</code></pre>
<p>Es gibt auch Parameter, die unter anderem die Darstellung des Codes und der Ergebnisse beeinflussen.
Man kann dabei mit <code>{r echo=c (-ErsteZeile:-LetzteZeile)}</code> einzelne Zeilen und Abschnitte des Codes verstecken, etwa wie im Folgenden eine logische Abfrage, die einen passenden Text für jedes Ergebnis eines leveneTests ausgibt.</p>
<pre class="r"><code>#Prüfung der Homoskedastizität
leveneTest(fb22$nerd[!is.na(fb22$nerd) &amp; !is.na(fb22$job)] ~ as.factor(fb22$job[!is.na(fb22$nerd) &amp; !is.na(fb22$job)]))</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value  Pr(&gt;F)  
## group   1  4.2153 0.04183 *
##       147                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Die Homoskedastizitätsannahme wird verworfen, daher wird eine Welch-Korrektur genutzt. (Dieser Text wurde aus der logischen Abfrage erstellt)</p>
<p>Und mit <code>{r results="hide"}</code> kann man verhindern, dass Ergebnisse, wie das vom leveneTest, überhaupt ausgegeben werden.</p>
<pre class="r"><code>leveneTest(fb22$nerd[!is.na(fb22$nerd) &amp; !is.na(fb22$job)] ~ as.factor(fb22$job[!is.na(fb22$nerd) &amp; !is.na(fb22$job)]))</code></pre>
<p>Die Plotdarstellung kann ähnlich manipuliert und angepasst werden:</p>
<pre class="r"><code>#Erster QQ-Plot
qqnorm(scale(fb22$nerd[fb22$job==2]))
qqline(scale(fb22$nerd[fb22$job==2]))</code></pre>
<p><img src="/post/2023-02-10-RMarkdown_WIP_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<pre class="r"><code>#Zweiter QQ-Plot
qqnorm(scale(fb22$nerd[fb22$job==1]))
qqline(scale(fb22$nerd[fb22$job==1]))</code></pre>
<p>Hier wurde im Codeblock <code>{r fig.keep=c(2), fig.align='left'}</code> festgelegt, deswegen wird nun im Text nur der erste QQ-Plot gezeigt und dieser linksbündig dargestellt, während der andere nicht dargestellt wird. Auch hier gibt es wieder eine Vielzahl an Optionen, mit denen man Plots verschieden individualisieren kann. PARAMETER VERLINKEN</p>
</div>
<div id="Setup" class="section level2 anchorheader">
<h2>Der Sonderfall: Setup mit knitr</h2>
<p>Der erste Code-Chunk in einem Dokument, der beim Erstellen eines neuen RMarkdown-Dokuments auch in RStudio miterstellt wird, ist typischerweise der Setup-Chunk. In ihm lassen sich durch Argumente verschiedene Regeln festlegen die im <code>default</code> auf jeden weiteren Code-Chunk zutreffen werden. Die <a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf?_ga=2.102259713.1013981012.1677056319-671987487.1666819594">möglichen Befehle</a> innerhalb des Setup-Chunks sind weitreichend, meist wird dort aber nur definiert, ob man seinen Code und seine Ergebnisse standardmäßig anzeigen möchte und ob Warnungen oder Nachrichten angezeigt werden sollen. Letztere Optionen lauten bspw.</p>
<pre><code>knitr::opts_chunk$set(include= TRUE, echo = TRUE, message = TRUE, warning = TRUE)
include -&gt;
echo -&gt;
message -&gt;
warning -&gt;</code></pre>
<p>wenn man alle Elemente mit anzeigen möchte. Aber dies muss man auch nicht unbedingt selbst setzen, diese 4 Werte sind beispielsweise als <code>default = TRUE</code>, also standardmäßig auf <code>TRUE</code> gesetzt, und müssen daher eigentlich nur angepasst werden, wenn man sie spezifisch auf <code>FALSE</code> setzen will.</p>
</div>
<div id="WD" class="section level2 anchorheader">
<h2>Working Directory</h2>
<p>Das Working Directory des RMD ist identisch zu dem, wie man es von R-Skripten gewohnt ist, es ist standardmäßig auf den Ordner gesetzt, in dem die RMD-Datei sich befindet. Mit einem Setup-Befehl lässt sich dieser auch anpassen, dieser sieht etwas komplexer aus, als man es von <code>setwd()</code> vielleicht gewohnt ist, erfüllt aber die selbe Funktion.</p>
<pre><code>knitr::opts_knit$set(root.dir = &#39;/Ordner&#39;)</code></pre>
</div>
<div id="Inline" class="section level2 anchorheader">
<h2>Inline Code &amp; Parameter</h2>
<p>Genau so, wie man Abschnitte im Text visuell als Code herausstellen kann in RMarkdown, lässt sich auch R-Code im Text ausführen. In diesem Dokument wurden bspw. zu Beginn in einem nicht sichtbaren Codeblock zwei zufällige Zahlen zwischen 1 und 20 in einen Vektor gelegt.</p>
<p>Dieser Vektor lässt sich nun direkt darstellen mit <code>r numberFunc</code> , umschlossen von zwei Backticks <code>``</code>: 15, 11.</p>
<p>Der Vektor der zwei Zahlen wird dabei direkt in einer Aufführung mit Kommas dargestellt. Die Zahlen werden immer neu randomisiert, wenn das Dokument bearbeitet und neu geladen wird.</p>
</div>
<div id="fazit" class="section level2">
<h2>Fazit</h2>
<p>RMarkdown kombiniert alle Facetten von Markdown, Pandoc und RMarkdown und kann so genutzt werden um R-Code und andere Inhalte dynamisch in einer Reihe verschiedener Formate auszugeben und darzustellen</p>
<hr />
</div>
