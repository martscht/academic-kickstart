---
title: "RMarkdown"
date: '2023-02-10'
slug: RMarkdown
categories:
  - extras
tags:
subtitle: ''
summary: ''
authors: [pommeranz]
lastmod: '2023-03-24'
featured: no
header:
  image: "/header/" #https://pxhere.com/de/photo/29 maybe this?
  caption: "[Courtesy of pxhere](https://pxhere.com/de/photo/29)"
projects: []
---



<div id="was-ist-rmarkdown" class="section level2">
<h2>Was ist RMarkdown?</h2>
<p>RMarkdown ist ein Framework, welches es ermöglicht, die Arbeit mit Daten in der Programmiersprache R möglichst transparent darzustellen und in einem Dokument aufzubereiten.Der Nutzen dahinter liegt unter anderem in gut einsehbarer und reproduzierbarer Forschung, da man damit seinen Workflow erweitert erläutern und visualisieren kann. Mit hinterlegtem Quellcode können auch mögliche Fehler in der Datenaufbereitung und -verarbeitung transparent von außen einsehbar werden.</p>
</div>
<div id="rmarkdown-datei-erstellen" class="section level2">
<h2>RMarkdown-Datei erstellen</h2>
<p>Um eine RMarkdown-Datei zu erstellen, muss man in RStudio oben links eine neue Datei erstellen, und dort RMarkdown auswählen. Nun sollte sich ein Fenster öffnen in dem man einige Angaben treffen kann. Die ersten drei Parameter sind dabei relativ selbsterklärend, der Titel des Markdown-Dokuments, das Datum der Erstellung sowie der Name der/des Autor*in des Dokuments. Das Output-Format hingegen bestimmt, in welcher Form das Dokument ausgegeben werden soll, PDF, Word oder Html. Diese Parameter lassen sich später aber noch anpassen.</p>
<!-- Hier Bild einfügen -->
</div>
<div id="aufbau-des-dokuments" class="section level2">
<h2>Aufbau des Dokuments</h2>
<p>Eine RMarkdown-Datei enthält typischerweise einen <strong>Head</strong> und einen <strong>Textkörper</strong>, sowie <strong>Code-Chunks/Code-Blöcke</strong>.</p>
<p>Im Head des Dokuments befinden sich die Argumente die beim Erstellen übergeben wurden. Es gibt viele weitere Output-Möglichkeiten wie beispielsweise Powerpoint-Slides. Auf der <a href="https://rmarkdown.rstudio.com/lesson-9.html">Seite von RStudio</a> gibt es eine Liste weiterer Optionen.</p>
<p>Im eigentlichen Textkörper steht einfacher Text, wie er auch hier steht. Manchmal sind im Text <a href="">Links</a> gesetzt, oder auch <em>schiefgestellter</em> oder <strong>fettgedruckter</strong> Text, dies wird auch mit Markdown-Syntax umgesetzt.</p>
<p>Die Code Chunks sind das, was ein RMarkdown von einem “normalen” Markdown-Dokument unterscheidet. Mit ihnen lässt sich R-Code in ein Dokument einbauen und ausführen, womit man unter anderem Grafiken und Ergebnisse automatisch berechnen und darstellen lassen kann.</p>
<p>Wie diese Bestandteile im Detail funktionieren, wird im folgenden schrittweise aufgeklärt.</p>
</div>
<div id="markdown-syntax" class="section level2">
<h2>Markdown Syntax</h2>
<p>RMarkdown verwendet eine Syntax, die auf <a href="https://pandoc.org/MANUAL.html#pandocs-markdown">Pandoc Markdown</a> basiert. Pandocs Markdown ist dabei ein Vermittler, der zwischen verschiedenen Markdownformaten übersetzen kann. Auch <em>Blockelemente</em> lassen sich in Markdown erstellen, womit man beispielsweise Codeblocks teilen kann, dazu ein Beispiel aus dem PsyBsc2-Kurs:</p>
<pre><code># Daten laden
load(url(&#39;https://pandar.netlify.app/post/fb22.rda&#39;))  </code></pre>
<p>Dies geht mit drei Backticks <code>```</code> die jeweils über und unter dem Codeabschnitt stehen</p>
</div>
<div id="working-directory" class="section level2">
<h2>Working Directory</h2>
</div>
<div id="code-chunks" class="section level2">
<h2>Code Chunks</h2>
<p>Mit Code Chunks lässt sich R-Code in ein Dokument einbauen um Ergebnisse, Analysen und Grafiken in einen Fließtext dynamisch zu integrieren. Erstellt werden diese mit einem Codeblock, mit einem Zusatzargument, der die Programmiersprache des Blocks definiert.</p>
<pre><code>```{r }⠀
R-Code
```⠀</code></pre>
<p>Hier ein Beispiel basierend auf dem Fragebogendatensatz fb22.</p>
<pre class="r"><code>#Fragebogendaten aus PsyBsc2 laden
load(url(&#39;https://pandar.netlify.app/post/fb22.rda&#39;))

#prüfen, ob n &gt;= 30
length(na.omit(fb22$nerd[fb22$job==2])) #Student*innen mit Nebenjob</code></pre>
<pre><code>## [1] 52</code></pre>
<pre class="r"><code>length(na.omit(fb22$nerd[fb22$job==1])) #Student*innen ohne Nebenjob</code></pre>
<pre><code>## [1] 97</code></pre>
<p>Es gibt auch Parameter, die unter anderem die Darstellung des Codes und der Ergebnisse beeinflussen.
Man kann dabei mit <code>{r echo=c (-ErsteZeile:-LetzteZeile)}</code> einzelne Zeilen und Abschnitte des Codes verstecken, etwa wie im Folgenden eine logische Abfrage, die einen passenden Text für jedes Ergebnis eines leveneTests ausgibt.</p>
<pre class="r"><code>#Prüfung der Homoskedastizität
leveneTest(fb22$nerd[!is.na(fb22$nerd) &amp; !is.na(fb22$job)] ~ as.factor(fb22$job[!is.na(fb22$nerd) &amp; !is.na(fb22$job)]))</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value  Pr(&gt;F)  
## group   1  4.2153 0.04183 *
##       147                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Die Homoskedastizitätsannahme wird verworfen, daher wird eine Welch-Korrektur genutzt. (Dieser Text wurde aus der logischen Abfrage erstellt)</p>
<p>Und mit <code>{r results="hide"}</code> kann man verhindern, dass Ergebnisse, wie das vom leveneTest, überhaupt ausgegeben werden.</p>
<pre class="r"><code>leveneTest(fb22$nerd[!is.na(fb22$nerd) &amp; !is.na(fb22$job)] ~ as.factor(fb22$job[!is.na(fb22$nerd) &amp; !is.na(fb22$job)]))</code></pre>
<p>Die Plotdarstellung kann ähnlich manipuliert und angepasst werden:</p>
<pre class="r"><code>#Erster QQ-Plot
qqnorm(scale(fb22$nerd[fb22$job==2]))
qqline(scale(fb22$nerd[fb22$job==2]))</code></pre>
<p><img src="/post/2023-02-10-RMarkdown_WIP_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<pre class="r"><code>#Zweiter QQ-Plot
qqnorm(scale(fb22$nerd[fb22$job==1]))
qqline(scale(fb22$nerd[fb22$job==1]))</code></pre>
<p>Hier wurde im Codeblock <code>{r fig.keep=c(2), fig.align='left'}</code> festgelegt, deswegen wird nun im Text nur der erste QQ-Plot gezeigt und dieser linksbündig dargestellt, während der andere nicht dargestellt wird. Auch hier gibt es wieder eine Vielzahl an Optionen, mit denen man Plots verschieden individualisieren kann. PARAMETER VERLINKEN</p>
</div>
<div id="setup-mit-knitr" class="section level2">
<h2>Setup mit knitr</h2>
<p>Der erste Code-Chunk in einem Dokument, der beim Erstellen eines neuen RMarkdown-Dokuments auch in RStudio miterstellt wird, ist typischerweise der Setup-Chunk. In ihm lassen sich durch Argumente verschiedene Regeln festlegen die im <code>default</code> auf jeden weiteren Code-Chunk zutreffen werden. Die <a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf?_ga=2.102259713.1013981012.1677056319-671987487.1666819594">möglichen Befehle</a> innerhalb des Setup-Chunks sind weitreichend, meist wird dort aber nur definiert, ob man seinen Code und seine Ergebnisse standardmäßig anzeigen möchte und ob Warnungen oder Nachrichten angezeigt werden sollen. Letztere Optionen lauten bspw.</p>
<pre><code>knitr::opts_chunk$set(include= TRUE, echo = TRUE, message = TRUE, warning = TRUE)
include -&gt;
echo -&gt;
message -&gt;
warning -&gt;</code></pre>
<p>wenn man alle Elemente mit anzeigen möchte. Aber dies muss man auch nicht unbedingt selbst setzen, diese 4 Werte sind beispielsweise als <code>default = TRUE</code>, also standardmäßig auf <code>TRUE</code> gesetzt, und müssen daher eigentlich nur angepasst werden, wenn man sie spezifisch auf <code>FALSE</code> setzen will.</p>
</div>
<div id="inline-code-parameter" class="section level2">
<h2>Inline Code &amp; Parameter</h2>
<p>Genau so, wie man Abschnitte im Text visuell als Code herausstellen kann in RMarkdown, lässt sich auch R-Code im Text ausführen. In diesem Dokument wurden bspw. zu Beginn in einem nicht sichtbaren Codeblock zwei zufällige Zahlen zwischen 1 und 20 in einen Vektor gelegt.</p>
<p>Dieser Vektor lässt sich nun direkt darstellen mit <code>r numberFunc</code> , umschlossen von zwei Backticks <code>``</code>: 17, 8.</p>
<p>Der Vektor der zwei Zahlen wird dabei direkt in einer Aufführung mit Kommas dargestellt. Die Zahlen werden immer neu randomisiert, wenn das Dokument bearbeitet und neu geladen wird.</p>
<hr />
</div>
