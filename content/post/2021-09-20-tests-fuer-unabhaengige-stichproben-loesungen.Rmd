---
title: Tests für unabhängige Stichproben - Lösungen
date: '2020-12-17'
slug: gruppenvergleiche-unabhaengig-loesungen
categories:
  - BSc2
tags:
  - t-Test
subtitle: ''
summary: ''
authors: [koehler, buchholz]
lastmod: '2021-12-22T13:15:14+01:00'
featured: no
header:
  image: "/header/BSc2_test_unabh_stpr.jpg"
  caption: "[Courtesy of pxhere](https://pxhere.com/en/photo/662606)"
projects: []
expiryDate: '2022-09-15'
publishDate: '2022-01-29'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(error = TRUE)
library(psych)
library(car)
library(effsize)
```

**Daten einlesen**

```{r echo=F}
load("fb21.rda")
```

```{r, eval=F}
setwd("...")  
load("fb21.rda")
```

**Daten aufbereiten**

Prüfe zunächst, ob die Variablen Faktoren sind.

```{r}
is.factor(fb21$fach)
is.factor(fb21$ort)
is.factor(fb21$geschl)
```

Falls nicht:

```{r}
# Lieblingsfach als Faktor - falls es noch keiner war
fb21$fach <- factor(fb21$fach, 
                    levels = 1:5,
                    labels = c('Allgemeine', 'Biologische', 'Entwicklung',
                               'Klinische', 'Diag./Meth.'))

# Wohnort als Faktor - falls es noch keiner war
fb21$ort <- factor(fb21$ort, 
                   levels = c(1, 2),
                   labels = c('Frankfurt', 'anderer'))


# Geschlecht als Faktor - falls es noch keiner war
fb21$geschl <- factor(fb21$geschl, 
                      levels=c(1,2,3), 
                      labels=c('weiblich', 'maennlich', 'anderes'))
```

***

## Aufgabe 1
Unterscheiden sich Studierende, die sich für Allgemeine Psychologie (Variable "fach") interessieren, im Persönlichkeitsmerkmal Intellekt (auch: Offenheit für neue Erfahrungen, "intel") von Studierenden, die sich für Klinische Psychologie interessieren? Normalverteilung des Merkmals in der Population darf angenommen werden. 

<details><summary>Lösung</summary>
**Deskriptivstatistische Beantwortung der Fragestellung: grafisch**
```{r}
data1 <- fb21[ (which(fb21$fach=="Allgemeine"|fb21$fach=="Klinische")), ]
data1$fach <- droplevels(data1$fach)
boxplot(data1$intel ~ data1$fach,
        xlab="Interessenfach", ylab="Intellekt", 
        las=1, cex.lab=1.5, 
        main="Interessenfach und Intellekt")
```

**Deskriptivstatistische Beantwortung der Fragestellung: statistisch**

```{r}
# Überblick

library(psych)
describeBy(data1$intel, data1$fach)

# Berechnung der empirischen Standardabweichung

intel.A <- data1$intel[(data1$fach=="Allgemeine")]
sigma.A <- sd(intel.A)
n.A <- length(intel.A[!is.na(intel.A)])
sd.A <- sigma.A * sqrt((n.A-1) / n.A)
sd.A 

intel.B <- data1$intel[(data1$fach=="Klinische")]
sigma.B <- sd(intel.B)
n.B <- length(intel.B[!is.na(intel.B)])
sd.B <- sigma.B * sqrt((n.B-1) / n.B)
sd.B
```

Mittelwert der Allgemeinen Psychologen (_M_ = `r round(mean(intel.A), 2)`, _SD_ = `r round(sd.A, 2)`) unterscheidet sich deskriptivstatistisch vom Mittelwert der Klinischen (_M_ = `r round(mean(intel.B), 2)`, _SD_ = `r round(sd.B, 2)`).


**Voraussetzungsprüfung: Normalverteilung**

```{r}
par(mfrow=c(1,2))
intel.A <- data1[which(data1$fach=="Allgemeine"), "intel"]
hist(intel.A, xlim=c(1,6), main="Intellekt (Allgemeine Psy.)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(intel.A, na.rm=T), sd=sd(intel.A, na.rm=T)), col="blue", lwd=2, add=T)
qqnorm(intel.A)
qqline(intel.A, col="blue")
```

$\rightarrow$ Entscheidung: Normalverteilung wird für Gruppe 1 (Allgemeine Psycholgie) angenommen  

```{r}
par(mfrow=c(1,2))
intel.B <- data1[which(data1$fach=="Klinische"), "intel"]
hist(intel.B, xlim=c(1,6), main="Intellekt (Klinische Psy.)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(intel.B, na.rm=T), sd=sd(intel.B, na.rm=T)), col="blue", lwd=2, add=T)
qqnorm(intel.B)
qqline(intel.B, col="blue")
```

$\rightarrow$ Entscheidung: Normalverteilung wird für Gruppe 2 (Klinische Psycholgie) angenommen 

**Hypothesen**

* Art des Effekts: Unterschiedshypothese  
* Richtung des Effekts: Ungerichtet $\rightarrow$ ungerichtete Hypothesen  
* Größe des Effekts: Unspezifisch  

Hypthesenpaar (statistisch):  

* $H_0$: $\mu_\text{Allgemeine} =   \mu_\text{Klinische}$
* $H_1$: $\mu_\text{Allgemeine} \ne \mu_\text{Klinische}$

**Spezifikation des Signifikanzniveaus** 

$\alpha = .05$

**Voraussetzungsprüfung: Varianzhomogenität**

```{r}
library(car)
leveneTest(data1$intel ~ data1$fach)
```

_F_(1,63) = 0.05, _p_ = .824 $\rightarrow$ Das Ergebnis ist nicht signifikant, die $H_0$ wird beibehalten und Varianzhomogenität angenommen.

**Durchführung des _t_-Tests**

```{r}
t.test(data1$intel ~ data1$fach,           # abhängige Variable ~ unabhängige Variable
       paired = F,                   # Stichproben sind unabhängig 
       alternative = "two.sided",         # zweiseitige Testung
       var.equal = T,                # Varianzhomogenität ist gegeben (-> Levene-Test)
       conf.level = .95)             # alpha = .05 
```


**Formales Berichten des Ergebnisses**

Es wurde untersucht, ob sich Studierende, die sich für Allgemeine Psychologie interessieren, im Persönlichkeitsmerkmal 'Intellekt' (auch: Offenheit für neue Erfahrungen) von Studierenden, die sich für Klinische Psychologie interessieren, unterscheiden. Deskriptiv liegt ein solcher Unterschied vor: Die Mittelwerte betragen 3.87 (Allgemeine, _SD_ = 0.66) und 3.56 (Klinische, _SD_ = 0.61). Der entsprechende _t_-Test zeigt jedoch ein nicht signifikantes Ergebnis (_t_(_df_ = 63, zweis.) = 1.86, _p_ = .067). Die Nullhypothese konnte nicht verworfen werden und wird beibehalten. Die Studierenden sind im Persönlichkeitsmerkmal 'Intellekt' unabhängig davon, ob sie sich für Allgemeine Psychologie oder für Klinische Psychologie interessieren.

</details>

## Aufgabe 2
Sind Studierende, die außerhalb von Frankfurt wohnen ("ort"), zufriedener im Leben ("lz") als diejenigen, die innerhalb von Frankfurt wohnen?  

<details><summary>Lösung</summary>
**Deskriptivstatistische Beantwortung der Fragestellung: grafisch**

```{r}
boxplot(fb21$lz ~ fb21$ort,
        xlab="Wohnort", ylab="Lebenszufriedenheit", 
        las=1, cex.lab=1.5, 
        main="Wohnort und Lebenszufriedenheit")
```

**Deskriptivstatistische Beantwortung der Fragestellung: statistisch**

```{r}
library(psych)
describeBy(fb21$lz, fb21$ort)
summary(fb21[which(fb21$ort=="Frankfurt"), "lz"])
summary(fb21[which(fb21$ort=="anderer"), "lz"])
```

Mittelwert der Nicht-Frankfurter:innen ist deskriptiv höher als der der Frankfurter:innen.

**Voraussetzungsprüfung: Normalverteilung**

```{r, fig.height=4, fig.align="center"}
par(mfrow=c(1,2))
lz.F <- fb21[which(fb21$ort=="Frankfurt"), "lz"]
hist(lz.F, xlim=c(1,9), ylim=c(0,.35), main="Lebenzufriedenheit\n(Frankfurter)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(lz.F, na.rm=T), sd=sd(lz.F, na.rm=T)), col="red", lwd=2, add=T)
qqnorm(lz.F)
qqline(lz.F, col="red")
```

$\rightarrow$ Entscheidung: Normalverteilung wird angenommmen

```{r, fig.height=4, fig.align="center"}
par(mfrow=c(1,2))
lz.a <- fb21[which(fb21$ort=="anderer"), "lz"]
hist(lz.a, xlim=c(1,9), main="Lebenszufriedenheit\n(Nicht-Frankfurter)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(lz.a, na.rm=T), sd=sd(lz.a, na.rm=T)), col="red", lwd=2, add=T)
qqnorm(lz.a)
qqline(lz.a, col="red")
```

$\rightarrow$ Entscheidung: Normalverteilung wird nicht angenommmen 


**Hypothesen**

* Art des Effekts: Unterschiedshypothese  
* Richtung des Effekts: Gerichtet $\rightarrow$ gerichtete Hypothesen  
* Größe des Effekts: Unspezifisch  

Hypthesenpaar (statistisch):  

* $H_0$: $\eta_\text{Frankfurter} \ge \eta_\text{nicht-Frankfurter}$  
* $H_1$: $\eta_\text{Frankfurter} <   \eta_\text{nicht-Frankfurter}$

**Spezifikation des Signifikanzniveaus**

$\alpha = .05$

**Durchführung des Wilcoxon-Tests**

```{r}
wilcox.test(fb21$lz ~ fb21$ort,           # abhängige Variable ~ unabhängige Variable
       paired = F,                   # Stichproben sind unabhängig 
       alternative = "less",         # einseitige Testung: Gruppe1 (Frankfurter) < Gruppe2 (Nicht-Frankfurter) 
       conf.level = .95)             # alpha = .05 
```

**Formales Berichten des Ergebnisses** 

Es wurde untersucht, ob außerhalb von Frankfurt wohnende Studierende zufriedener im Leben sind als die in Frankfurt wohnenden. Deskriptiv  zeigt sich tatsächlich, dass die Nicht-Frankfurter:innen zufriedener sind (_Mdn_ = 5.2, _IQB_ = [4.6; 5.6]) als die Frankfurter:innen (_Mdn_ = 5, _IQB_ = [4.0; 5.8]). entsprechende Wilcoxon-Test zeigt jedoch ein nicht signifikantes Ergebnis (_W_ = 1512.5, _p_ = .501). Die Nullhypothese konnte nicht verworfen werden und wird beibehalten. Die Studierenden sind gleich zufrieden, unabhängig von ihrem Wohnort.


</details>

## Aufgabe 3
Ist die Wahrscheinlichkeit dafür, innerhalb von Frankfurt zu wohnen, die gleiche für weibliche wie für männliche Erstsemester-Studierende der Psychologie?

<details><summary>Lösung</summary>
Beide Variablen sind nominalskaliert $\rightarrow \chi^2$-Test

**Voraussetzungen**  

1. Die einzelnen Beobachtungen sind voneinander unabhängig $\rightarrow$ ok
2. Jede Person lässt sich eindeutig einer Kategorie bzw. Merkmalskombination zuordnen $\rightarrow$ ok
3. Zellbesetzung für alle $n_{ij}$ > 5 $\rightarrow$ Prüfung anhand von Häufigkeitstabelle 

```{r}
fb21$geschlecht <- fb21$geschl
fb21$geschlecht[fb21$geschlecht=="anderes"] <- NA #Umkodieren von "anderes" in fehlenden Wert
fb21$geschlecht <- droplevels(fb21$geschlecht) #Level "anderes" wird eliminiert
tab <- table(fb21$geschlecht, fb21$ort)
tab
```

$\rightarrow n_{ij}$ > 5 in allen Zellen gegeben

**Hypothesen**

* Art des Effekts: Zusammenhangshypothese
* Richtung des Effekts: Ungerichtet
* Größe des Effekts: Unspezifisch

Hyothesenpaar (inhaltlich):  

* $H_0$: Weibliche und männliche Studierende der Psychologie wohnen mit gleicher Wahrscheinlichkeit innerhalb bzw. außerhalb von Frankfurt.  
* $H_1$: Weibliche und männliche Studierende der Psychologie unterscheiden sich in der Wahrscheinlichkeit, innerhalb bzw. außerhalb von Frankfurt zu wohnen.  

Hypothesenpaar (statistisch):  

* $H_0$: $\pi_{ij} =    \pi_{i\bullet} \cdot \pi_{\bullet j}$  
* $H_1$: $\pi_{ij} \neq \pi_{i\bullet} \cdot \pi_{\bullet j}$ 

**Durchführung des $\chi^2$-Test in R**

```{r}
chisq.test(tab, correct=FALSE)
```

$\chi^2 = 0.481, df = 1, p = .488 \rightarrow H_0$

**Effektstärke Phi ($\phi$)**

```{r}
library(psych)
phi(tab)
```

**Ergebnisinterpretation**

Es wurde untersucht, ob sich männliche und weibliche Studierende in ihrem Wohnort (Frankfurt vs. außerhalb) unterscheiden. Zur Beantwortung der Fragestellung wurde ein Vierfelder-Chi-Quadrat-Test für unabhängige Stichproben berechnet. Der Zusammenhang zwischen Wohnort und Geschlecht ist nicht signifikant ($\chi^2(1) = 0.481, p = .488$), somit wird die Nullhypothese beibehalten. Der Effekt ist von vernachlässigbarer Stärke ($\phi = .07$). Männliche und weibliche Studierende wohnen also mit gleicher Wahrscheinlichkeit in Frankfurt bzw. außerhalb von Frankfurt.

</details>

