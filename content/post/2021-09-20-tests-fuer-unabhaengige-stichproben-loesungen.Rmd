---
title: Tests für unabhängige Stichproben - Lösungen
date: '2020-12-17'
slug: gruppenvergleiche-unabhaengig-loesungen
categories:
  - BSc2
tags:
  - t-Test
subtitle: ''
summary: ''
authors: [koehler, scheppa-lahyani]
lastmod: '2020-12-17T13:15:14+01:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
expiryDate: '2022-09-15'
publishDate: '2021-12-10'
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(error = TRUE)
library(psych)
library(car)
library(effsize)
```

**Daten einlesen**

```{r echo=F}
fb20 <- read.table('https://pandar.netlify.app/post/fb20.csv', 
  header = TRUE,
  sep = ',',
  na.strings = '-99')
```

```{r, eval=F}
setwd("...")  
load("fb20.rda")
```

**Daten aufbereiten**

```{r}
# Lieblingsfach als Faktor - falls es noch keiner war
if(is.factor(fb20$fach) == FALSE){
  fb20$fach <- factor(fb20$fach, 
                      levels = 1:5,
                      labels = c('Allgemeine', 'Biologische', 'Entwicklung',
                                 'Klinische', 'Diag./Meth.'))
}

# Wohnort als Faktor - falls es noch keiner war
if(is.factor(fb20$ort) == FALSE){
  fb20$ort <- factor(fb20$ort, 
                     levels = c(1, 2),
                     labels = c('Frankfurt', 'anderer'))
}

# Geschlecht als Faktor - falls es noch keiner war
if(is.factor(fb20$geschl)==FALSE){
  fb20$geschl <- factor(fb20$geschl, 
                        levels=c(1,2,3), 
                        labels=c('weiblich', 'maennlich', 'anderes'))
}
```

***

## Aufgabe 1
Unterscheiden sich Studierende, die sich für Allgemeine Psychologie (Variable "fach") interessieren, im Persönlichkeitsmerkmal Intellekt (auch: Offenheit für neue Erfahrungen, "intell") von Studierenden, die sich für Klinische Psychologie interessieren? Normalverteilung des Merkmals in der Population darf angenommen werden. 

<details><summary>Lösung</summary>
**Deskriptivstatistische Beantwortung der Fragestellung: grafisch**
```{r, fig.height = 10}
data1 <- fb20[ (which(fb20$fach=="Allgemeine"|fb20$fach=="Klinische")), ]
data1$fach <- droplevels(data1$fach)
boxplot(data1$intel ~ data1$fach,
        xlab="Interessenfach", ylab="Intellekt", 
        las=1, cex.lab=1.5, 
        main="Interessenfach und Intellekt")
```

**Deskriptivstatistische Beantwortung der Fragestellung: statistisch**

```{r}
# Überblick

library(psych)
describeBy(data1$intel, data1$fach)

# Berechnung der empirischen Standardabweichung

intel.A <- data1$intel[(data1$fach=="Allgemeine")]
sigma.A <- sd(intel.A)
n.A <- length(intel.A[!is.na(intel.A)])
sd.A <- sigma.A * sqrt((n.A-1) / n.A)
sd.A 

intel.B <- data1$intel[(data1$fach=="Klinische")]
sigma.B <- sd(intel.B)
n.B <- length(intel.B[!is.na(intel.B)])
sd.B <- sigma.B * sqrt((n.B-1) / n.B)
sd.B
```

Mittelwert der Allgemeinen Psychologen (_M_ = `r round(mean(intel.A), 2)`, _SD_ = `r round(sd.A, 2)`) unterscheidet sich deskriptivstatistisch vom Mittelwert der Klinischen (_M_ = `r round(mean(intel.B), 2)`, _SD_ = `r round(sd.B, 2)`).


**Voraussetzungsprüfung: Normalverteilung**

```{r}
par(mfrow=c(1,2))
intel.A <- data1[which(data1$fach=="Allgemeine"), "intel"]
hist(intel.A, xlim=c(1,6), main="Intellekt (Allgemeine Psy.)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(intel.A, na.rm=T), sd=sd(intel.A, na.rm=T)), col="blue", lwd=2, add=T)
qqnorm(intel.A)
qqline(intel.A, col="blue")
```

$\rightarrow$ Entscheidung: Normalverteilung wird für Gruppe 1 (Allgemeine Psycholgie) angenommen  

```{r}
par(mfrow=c(1,2))
intel.B <- data1[which(data1$fach=="Klinische"), "intel"]
hist(intel.B, xlim=c(1,6), main="Intellekt (Klinische Psy.)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(intel.B, na.rm=T), sd=sd(intel.B, na.rm=T)), col="blue", lwd=2, add=T)
qqnorm(intel.B)
qqline(intel.B, col="blue")
```

$\rightarrow$ Entscheidung: Normalverteilung wird für Gruppe 2 (Klinische Psycholgie) nicht angenommen 

**Hypothesen**

* Art des Effekts: Unterschiedshypothese  
* Richtung des Effekts: Ungerichtet $\rightarrow$ ungerichtete Hypothesen  
* Größe des Effekts: Unspezifisch  

Hypthesenpaar (statistisch):  

* $H_0$: $\mu_{Allgemeine} =   \mu_{Klinische}$
* $H_1$: $\mu_{Allgemeine} \ne \mu_{Klinische}$

**Spezifikation des Signifikanzniveaus** 

$\alpha = .05$

**Durchführung des Wilcoxon-Tests**

```{r}
wilcox.test(data1$intel ~ data1$fach,  # abhängige Variable ~ unabhängige Variable
       paired = F,                     # Stichproben sind unabhängig 
       alternative = "two.sided",      # zweiseitige Testung 
       conf.level = .95)               # alpha = .05 
```


**Formales Berichten des Ergebnisses**

Es wurde untersucht, ob sich Studierende, die sich für Allgemeine Psychologie interessieren, im Persönlichkeitsmerkmal Intellekt (auch: Offenheit für neue Erfahrungen) von Studierenden, die sich für Klinische Psychologie interessieren, unterscheiden. Deskriptiv liegt ein solcher Unterschied vor: Die Mittelwerte betragen 3.72 (Allgemeine, _SD_ = 0.38) und 3.60 (Klinische, _SD_ = 0.65). Der entsprechende Wilcoxon-Test zeigt jedoch ein nicht signifikantes Ergebnis (_W_ = 370, _p_ = .362).
</details>

## Aufgabe 2
Sind Studierende, die außerhalb von Frankfurt wohnen ("ort"), zufriedener im Leben ("lz") als diejenigen, die innerhalb von Frankfurt wohnen?  

<details><summary>Lösung</summary>
**Deskriptivstatistische Beantwortung der Fragestellung: grafisch**

```{r, fig.height = 10}
boxplot(fb20$lz ~ fb20$ort,
        xlab="Wohnort", ylab="Lebenszufriedenheit", 
        las=1, cex.lab=1.5, 
        main="Wohnort und Lebenszufriedenheit")
```

**Deskriptivstatistische Beantwortung der Fragestellung: statistisch**

```{r}
library(psych)
describeBy(fb20$lz, fb20$ort)
summary(fb20[which(fb20$ort=="Frankfurt"), "lz"])
summary(fb20[which(fb20$ort=="anderer"), "lz"])
```

Mittelwert der Nicht-Frankfurter ist deskriptiv  höher als der der Frankfurter.

**Voraussetzungsprüfung: Normalverteilung**

```{r, fig.height=4, fig.align="center"}
par(mfrow=c(1,2))
lz.F <- fb20[which(fb20$ort=="Frankfurt"), "lz"]
hist(lz.F, xlim=c(1,9), main="Lebenzufriedenheit\n(Frankfurter)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(lz.F, na.rm=T), sd=sd(lz.F, na.rm=T)), col="red", lwd=2, add=T)
qqnorm(lz.F)
qqline(lz.F, col="red")
```

$\rightarrow$ Entscheidung: Normalverteilung wird angenommmen

```{r, fig.height=4, fig.align="center"}
par(mfrow=c(1,2))
lz.a <- fb20[which(fb20$ort=="anderer"), "lz"]
hist(lz.a, xlim=c(1,9), main="Lebenszufriedenheit\n(Nicht-Frankfurter)", xlab="", ylab="", las=1, prob=T)
curve(dnorm(x, mean=mean(lz.a, na.rm=T), sd=sd(lz.a, na.rm=T)), col="red", lwd=2, add=T)
qqnorm(lz.a)
qqline(lz.a, col="red")
```

$\rightarrow$ Entscheidung: Normalverteilung wird angenommmen 

**Voraussetzungsprüfung: Varianzhomogenität**

```{r}
library(car)
leveneTest(fb20$lz ~ fb20$ort)
```

_F_(1,86) = 0.43, _p_ = .513 $\rightarrow$ Das Ergebnis ist nicht signifikant, die $H_0$ wird beibehalten und Varianzhomogenität angenommen.

**Hypothesen**

* Art des Effekts: Unterschiedshypothese  
* Richtung des Effekts: Gerichtet $\rightarrow$ gerichtete Hypothesen  
* Größe des Effekts: Unspezifisch  

Hypthesenpaar (statistisch):  

* $H_0$: $\eta_{Frankfurter} \ge \eta_{nicht-Frankfurter}$  
* $H_1$: $\eta_{Frankfurter} <   \eta_{nicht-Frankfurter}$

**Spezifikation des Signifikanzniveaus**

$\alpha = .05$

**Durchführung des _t_-Tests**

```{r}
levels(fb20$ort)
t.test(fb20$lz ~ fb20$ort,           # abhängige Variable ~ unabhängige Variable
       paired = F,                   # Stichproben sind unabhängig 
       alternative = "less",         # einseitige Testung: Gruppe1 (Frankfurter) < Gruppe2 (Nicht-Frankfurter) 
       var.equal = T,                # Varianzhomogenität ist gegeben (-> Levene-Test)
       conf.level = .95)             # alpha = .05 
```

**Formales Berichten des Ergebnisses** 

Es wurde untersucht, ob außerhalb von Frankfurt wohnende Studierende zufriedener im Leben sind als die in Frankfurt wohnenden. Deskriptiv  zeigt sich tatsächlich, dass die Nicht-Frankfurter zufriedener sind (_M_ = 5.17, _SD_ = 1.13) als die Frankfurter (_M_ = 5.05, _SD_ = 1.13). Der _t_-Test zeigt jedoch ein nicht signifikantes Ergebnis (_t_(_df_ = 86, eins.) = -.48, _p_ = .316). Die Nullhypothese konnte nicht verworfen werden und wird beibehalten. Die Studierenden sind gleich zufrieden, unabhängig von deren Wohnort.


</details>

## Aufgabe 3
Ist die Wahrscheinlichkeit dafür, innerhalb von Frankfurt zu wohnen, die gleiche für weibliche wie für männliche Erstsemester-Studierende der Psychologie?

<details><summary>Lösung</summary>
Beide Variablen sind nominalskaliert $\rightarrow \chi^2$-Test

**Voraussetungen**  

1. Die einzelnen Beobachtungen sind voneinander unabhängig $\rightarrow$ ok
2. Jede Person lässt sich eindeutig einer Kategorie bzw. Merkmalskombination zuordnen $\rightarrow$ ok
3. Zellbesetzung für alle $n_{ij}$ > 5 $\rightarrow$ Prüfung anhand von Häufigkeitstabelle 

```{r}
fb20$geschlecht <- fb20$geschl[fb20$geschl=="weiblich"|fb20$geschl=="maennlich"]
fb20$geschlecht <- droplevels(fb20$geschlecht)
tab <- table(fb20$geschlecht, fb20$ort)
tab
```

$\rightarrow n_{ij}$ > 5 in allen Zellen gegeben

**Hypothesen**

* Art des Effekts: Zusammenhangshypothese
* Richtung des Effekts: Ungerichtet
* Größe des Effekts: Unspezifisch

Hyothesenpaar (inhaltlich):  

* $H_0$: Weibliche und männliche Studierende der Psychologie wohnen mit gleicher Wahrscheinlichkeit innerhalb bzw. außerhalb von Frankfurt.  
* $H_1$: Weibliche und männliche Studierende der Psychologie unterscheiden sich in der Wahrscheinlichkeit, innerhalb bzw. außerhalb von Frankfurt zu wohnen.  

Hypothesenpaar (statistisch):  

* $H_0$: $\pi_{ij} =    \pi_{i\bullet} \cdot \pi_{\bullet j}$  
* $H_1$: $\pi_{ij} \neq \pi_{i\bullet} \cdot \pi_{\bullet j}$ 

**Durchführung des $\chi^2$-Test in R**

```{r}
chisq.test(tab, correct=FALSE)
```

$\chi^2 = 0.320, df = 1, p = .572 \rightarrow H_0$

**Effektstärke Phi ($\phi$)**

```{r}
library(psych)
phi(tab)
```

**Ergebnisinterpretation**

Es wurde untersucht, ob sich männliche und weibliche Studierende in ihrem Wohnort (Frankfurt vs. außerhalb) unterscheiden. Zur Beantwortung der Fragestellung wurde ein Vierfelder-Chi-Quadrat-Test für unabhängige Stichproben berechnet. Der Zusammenhang zwischen Wohnort und Geschlecht ist nicht signifikant ($\chi^2(1) = 0.320, p = .572$), somit wird die Nullhypothese beibehalten. Der Effekt ist von vernachlässigbarer Stärke ($\phi = .06$). Männliche und weibliche Studierende wohnen also mit gleicher Wahrscheinlichkeit in Frankfurt bzw. außerhalb von Frankfurt.

</details>
