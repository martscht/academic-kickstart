---
title: Regression - Lösungen
author: 
date: '2021-01-04'
slug: regression-loesungen
categories:
  - BSc2
  - Loesungen
tags:
  - Regression
subtitle: ''
summary: ''
authors: [schroeder, neubauer]
lastmod: '2021-01-04T13:34:32+01:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
expiryDate: '2021-09-01'
publishDate: '2021-02-12'
---

## Vorbereitung
Laden Sie die Daten aus [<i class="fas fa-download"></i> `fb20.rda`](/post/fb20.rda).


```{r, eval = FALSE}
setwd(...) #auf eigenen Pfad
```

```{r}
load("fb20.rda")
```

***
# Regression
    
## Aufgabe 1
Welche der fünf Persönlichkeitsdimensionen Extraversion (`extra`), Verträglichkeit (`vertr`), Gewissenhaftigkeit (`gewis`), Neurotizsimus (`neuro`) und Intellekt (`intel`) zeigt den höchsten linearen Zusammenhang mit der Lebenszufriedenheit (`lz`)?

  * Erstellen Sie für jeden Zusammenhang je ein Streudiagramm.
**`extra`:**
```{r}
plot(fb20$extra, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
```

**`vertr`:**
```{r}
plot(fb20$vertr, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
```

**`gewis`:**
```{r}
plot(fb20$gewis, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
```

**`neuro`:**
```{r}
plot(fb20$neuro, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
```

**`intel`:**
```{r}
plot(fb20$intel, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
```
  
  * Schätzen Sie für jeden Zusammenhang je ein Modell.
**`extra`:**
```{r}
fme <- lm(lz ~ extra, fb20)
lm(formula = lz ~ 1 + extra, data = fb20)
coef(fme) 
summary(fme)

formula(fme)
```

**`vertr`:**
```{r}
fmv <- lm(lz ~ vertr, fb20)
lm(formula = lz ~ 1 + vertr, data = fb20) 
coef(fmv) 
summary(fmv)
formula(fmv)
```

**`gewis`:**
```{r}
fmg <- lm(lz ~ gewis, fb20)
lm(formula = lz ~ 1 + gewis, data = fb20) #Koeffizienten anzeigen, alternativ mit coef
coef(fmg) 
summary(fmg)
formula(fmg)
```

**`neuro`:**
```{r}
fmn <- lm(lz ~ neuro, fb20)
lm(formula = lz ~ 1 + neuro, data = fb20) 
coef(fmn) 
summary(fmn)
formula(fmn)
```

**`intel`:**
```{r}
fmi <- lm(lz ~ intel, fb20)
lm(formula = lz ~ 1 + intel, data = fb20) 
coef(fmi) 
summary(fmi)
formula(fmi)
```
Wenn wir die Koeffizienten der Modelle vergleichen, sehen wir, dass `gewis` den größten linearen Zusammenhang mit `lz` aufweist 
 
 * Prüfen Sie die Voraussetzungen und interpretieren Sie den standardisierten Koeffizienten des linearen Zusammenhangs zwischen Gewissenhaftigkeit und Lebenszufriedenheit. Wie verändert sich `lz`, wenn sich `gewis` um eine Standardabweichung erhöht?
 
### Voraussetzungen:

1. Linearität: Zusammenhang muss linear sein $\rightarrow$ Grafische Überprüfung (Scatterplot)  
2. Varianzhomogenität (Homoskedastizität) der Fehler: der Fehler jedes Wertes der UV hat annährend die gleiche Varianz  
3. Normalverteilung der Fehlervariablen  
4. Unabhängigkeit der Fehler  

Die Voraussetzungen 2-4 können erst geprüft werden, nachdem das Modell schon gerechnet wurde, weil sie sich auf die Fehler (Residuen: Differenz aus beobachtetem und vorhergesagtem Wert für y) beziehen!

**zu 1. Linearität: Zusammenhang muss linear sein $\rightarrow$ Grafische Überprüfung (Scatterplot)**

```{r}
plot(fb20$gewis, fb20$lz, xlab = "Gewissenhaftigkeit", ylab = "Lebenszufriedenheit", 
     main = "Zusammenhang zwischen Gewissenhaftigkeit und Lebenszufriedenheit", xlim = c(0, 6), ylim = c(0, 7), pch = 19)
lines(loess.smooth(fb20$gewis, fb20$lz), col = 'blue')    #beobachteter, lokaler Zusammenhang
fmg <- lm(lz ~ gewis, fb20)                              #Modell erstellen und ablegen
abline(fmg, col = "red")                                  #Modellierter linearer Zusammenhang in zuvor erstellten Plot einzeichnen
```

**zu Voraussetzungen 2-4:**

```{r}
par(mfrow = c(2, 2)) #Vier Abbildungen gleichzeitig
plot(fmg)
par(mfrow = c(1, 1)) #wieder auf eine Abbildung zurücksetzen
```


In diesem Fall ist alles weitestgehend erfüllt.

```{r}
sfmg <- lm(scale(lz) ~ scale(gewis), fb20)
sfmg

```

Wenn sich die Variable `gewis` um eine Standardabweichung verändert, verändert sich das Kriterium `lz` um 0,294 Standardabweichungen.

## Aufgabe 2
Ein paar Studierende wurden nachträglich zum Studiengang Psychologie zugelassen und befinden sich daher nicht im Datensatz. Die neuen Studenten wurden nachträglich befragt und weisen auf der Skala Neurotizismus folgende Werte auf: 1.25; 2.75; 3.5; 4.25; 3.75; 2.15. 

  * Machen Sie eine Vorhersage für die Lebenszufriedenheit für die neuen Studenten.
```{r}
new <- data.frame(neuro = c(1.25, 2.75, 3.5, 4.25, 3.75, 2.15))
predict(fmn, newdata = new)
```
  * Erstellen Sie ein Streu-Punkt-Diagramm  mit Regressionsgerade für den linearen Zusammenhang zwischen Neurotizismus und Lebenszufriedenheit.
```{r}
plot(fb20$neuro, fb20$lz, xlim = c(0, 6), ylim = c(0, 7), pch = 19)
abline(fmn, col = "red")
```
  
  * Wie viel Prozent der Varianz werden durch das Modell erklärt?
```{r}
summary(fmn)

```
R² = 0.066 --> 6,6% der Varianz von `lz` werden durch das Modell erklärt. Determinationskoeffizient $R^2$ ist signifikant.

***
