---
title: Korrelation - Lösungen
author: 
date: '2021-01-04'
slug: korrelation-loesungen
categories:
  - BSc2
  - Loesungen
tags:
  - Korrelation
subtitle: ''
summary: ''
authors: [nehler, winkler, schroeder]
lastmod: '2021-12-13T13:34:32+01:00'
featured: no
header:
  image: "/header/BSc2_Korrelation.jpg"
  caption: "[Courtesy of pxhere](https://pxhere.com/de/photo/855019)"
projects: []
expiryDate: '2022-09-15'
publishDate: '2022-01-14'
---

## Vorbereitung
Laden Sie den Datensatz `fb21` wie gewohnt ein.

<details><summary>Lösung</summary>

```{r}
load(url('https://pandar.netlify.app/post/fb21.rda')) # Daten laden
```
</details>

***
# Korrelation

## Aufgabe 1

In der Befragung am Anfang des Semesters wurde gefragt, ob Sie neben der Uni einen Nebenjob (`job`) ausüben und in welcher Wohnsituation Sie sich befinden (`wohnen`). Erstellen Sie für diese beiden Variablen eine Kreuztabelle mit Randsummen.

  * Stellen Sie zunächst sicher, dass die Variablen als Faktoren vorliegen und die Kategorien beider Variablen korrekt bezeichnet sind. 
  
  <details><summary>Lösung</summary>
```{r}  
#Labels
fb21$job <- factor(fb21$job, levels = c(1, 2),
  labels = c('nein', 'ja'))
fb21$wohnen <- factor(fb21$wohnen, levels = 1:4,
     label = c('WG', 'bei Eltern', 'alleine', 'sonstiges'))

str(fb21$job)
str(fb21$wohnen)
```
  </details> 

  * Wie viele Personen wohnen in einer WG und haben keinen Nebenjob? 
  
<details><summary>Lösung</summary>
```{r}
# Kreuztabelle absolut
tab <- table(fb21$job, fb21$wohnen)
addmargins(tab)
```
`r tab[1,1]` Personen wohnen in einer WG und haben keinen Nebenjob.  

</details>


  
  * Was ist der relative Anteil aller Teilnehmer:innen, die bei ihren Eltern wohnen?
  
<details><summary>Lösung</summary>
```{r}
# Relative Häufigkeiten, mit Randsummen
addmargins(prop.table(tab))
```
`r round(addmargins(prop.table(tab))[3,2]*100,2)`% aller Teilnehmer:innen wohnen bei ihren Eltern.

</details>



  * Welcher Anteil der Personen, die alleine wohnen, gehen einer Nebentätigkeit nach?
  
<details><summary>Lösung</summary>
```{r}
# Relative Häufigkeiten, an wohnen normiert
prop.table(tab, 2)
```
`r round(prop.table(tab, 2)[2,3]*100,2)`% aller Teilnehmer:innen, die alleine wohnen, gehen einer Nebentätigkeit nach.

</details>



## Aufgabe 2

Erstellen Sie für diese Kombination an Variablen ein gruppiertes Balkendiagramm.

  * Achten Sie darauf, dass die Balken nebeneinander stehen.
  * Nutzen Sie für die Personen mit und ohne Nebenjob unterschiedliche Farben und fügen Sie eine Legende hinzu, die das verdeutlicht.
  
<details><summary>Lösung</summary>
```{r}
# Gruppiertes Balkendiagramm
barplot(tab,
  beside = TRUE,             # nebeneinander
  col = c('blue', 'orange'), # Farben definieren: Blau und Orange
  legend = rownames(tab))    # Legende einfuegen
```
</details>

## Aufgabe 3

Welche der fünf Persönlichkeitsdimensionen Extraversion (`extra`), Verträglichkeit (`vertr`), Gewissenhaftigkeit (`gewis`), Neurotizismus (`neuro`) und Intellekt (`intel`) ist am stärksten mit der Lebenszufriedenheit korreliert (`lz`)?

  * Überprüfen Sie die Voraussetzungen für die Pearson-Korrelation.

<details><summary>Lösung</summary>  

  **Voraussetzungen Pearson-Korrelation:**  

1. Skalenniveau: intervallskalierte Daten $\rightarrow$ ok  
2. Linearität: Zusammenhang muss linear sein $\rightarrow$ Grafische überprüfung (Scatterplot) 


```{r}
# Scatterplot
plot(fb21$extra, fb21$lz, 
  xlim = c(0, 6), ylim = c(0, 7), pch = 19)

plot(fb21$vertr, fb21$lz, 
  xlim = c(0, 6), ylim = c(0, 7), pch = 19)

plot(fb21$gewis, fb21$lz, 
  xlim = c(0, 6), ylim = c(0, 7), pch = 19)

plot(fb21$neuro, fb21$lz, 
  xlim = c(0, 6), ylim = c(0, 7), pch = 19)

plot(fb21$intel, fb21$lz, 
  xlim = c(0, 6), ylim = c(0, 7), pch = 19)
```
</details>




<details><summary>Lösung</summary>

3. Normalverteilung $\rightarrow$ QQ-Plot, Histogramm oder Shapiro-Wilk-Test  


```{r}
#QQ
qqnorm(fb21$extra)
qqline(fb21$extra)

qqnorm(fb21$vertr)
qqline(fb21$vertr)

qqnorm(fb21$gewis)
qqline(fb21$gewis)

qqnorm(fb21$neuro)
qqline(fb21$neuro)

qqnorm(fb21$intel)
qqline(fb21$intel)

qqnorm(fb21$lz)
qqline(fb21$lz)

#Histogramm
hist(fb21$extra, prob = T, ylim = c(0, 1))
curve(dnorm(x, mean = mean(fb21$extra, na.rm = T), sd = sd(fb21$extra, na.rm = T)), col = "blue", add = T)  

hist(fb21$vertr, prob = T, ylim = c(0, 1))
curve(dnorm(x, mean = mean(fb21$vertr, na.rm = T), sd = sd(fb21$vertr, na.rm = T)), col = "blue", add = T)  

hist(fb21$gewis, prob = T, ylim = c(0, 1))
curve(dnorm(x, mean = mean(fb21$gewis, na.rm = T), sd = sd(fb21$gewis, na.rm = T)), col = "blue", add = T)  

hist(fb21$neuro, prob = T, ylim = c(0, 1))
curve(dnorm(x, mean = mean(fb21$neuro, na.rm = T), sd = sd(fb21$neuro, na.rm = T)), col = "blue", add = T)  

hist(fb21$intel, prob = T, ylim = c(0, 1))
curve(dnorm(x, mean = mean(fb21$intel, na.rm = T), sd = sd(fb21$intel, na.rm = T)), col = "blue", add = T)  

hist(fb21$lz, prob = T, ylim = c(0, 1))
curve(dnorm(x, mean = mean(fb21$lz, na.rm = T), sd = sd(fb21$lz, na.rm = T)), col = "blue", add = T)  

#Shapiro
shapiro.test(fb21$extra)
shapiro.test(fb21$vertr)
shapiro.test(fb21$gewis)
shapiro.test(fb21$neuro)
shapiro.test(fb21$intel)
shapiro.test(fb21$lz)


```
$p < \alpha$ $\rightarrow$ H1: Normalverteilung kann für alle Variablen außer `neuro` nicht angenommen werden. Somit ist diese Voraussetzung für die meisten Variablen verletzt. Daher sollten wir fortlaufend die Rangkorrelation nach Spearman nutzen.

</details>



  * Erstellen Sie für diese Frage eine Korrelationsmatrix, die alle Korrelationen enthält. Verwenden Sie die Funktion `round()` (unter Betrachtung der Hilfe), um die Werte auf zwei Nachkommastellen zu runden und die Tabelle dadurch übersichtlicher darzustellen.
  
<details><summary>Lösung</summary>
```{r}
# Variablen in neuem Datensatz ablegen
pers <- fb21[, c('lz', 'extra', 'vertr', 'gewis', 'neuro', 'intel')]
# Korrelationstabelle erstellen und runden
round(cor(pers, use = "pairwise", method = "spearman"),2)
```
```{r, echo=FALSE}
cor <- round(cor(pers, use = "pairwise", method = "spearman"),2)
```
</details>

  * Wie würden Sie das Ausmaß dieser Korrelation nach den Richtlinien von Cohen (1988) einschätzen?
  
<details><summary>Lösung</summary>
  
Die größte Korrelation mit der Lebenszufriedenheit hat die Gewissenhaftigkeit. Nach den Richtlinien ist diese mit `r cor[4]` einem positiven mittleren Effekt, der ungefähr 0.3 beträgt, zuzuordnen.

</details>

* Ist der Korrelationskoeffizient von Lebenszufriedenheit und Gewissenhaftigkeit statistisch signifikant?

<details><summary>Lösung</summary>
```{r}
cor.test(fb21$lz, fb21$gewis, 
         alternative = "two.sided", 
         method = "spearman",       
         use = "complete.obs")
```
$p < \alpha$ $\rightarrow$ H1. Die Korrelation ist mit einer Irrtumswahrscheinlichkeit von 5% signifikant von 0 verschieden.

</details>

## Aufgabe 4
Berechnen sie die Pearson-Korrelation, die Spearman-Korrelation, Kendall's Tau sowie $\hat{\gamma}$ für den Zusammenhang von `prok1` und `prok6`.

<details><summary>Lösung</summary>
```{r}
library(rococo)
cor(fb21$prok1, fb21$prok6, method = "pearson")
cor(fb21$prok1, fb21$prok6, method = "spearman")
cor(fb21$prok1, fb21$prok6, method = "kendall")
rococo(fb21$prok1, fb21$prok6)
```
</details>

## Aufgabe 5

Das Paket `psych` enthält vielerlei Funktionen, die für die Analyse von Datensätzen aus psychologischer Forschung praktisch sind. Eine von ihnen (`describe()`) erlaubt es, gleichzeitig verschiedene Deskriptivstatistiken für Variablen zu erstellen.

  * Installieren und laden Sie das Paket `psych`.
  
<details><summary>Lösung</summary>
```{r, eval = FALSE}
# Paket installieren
install.packages('psych')
```
```{r}
# Paket laden
library(psych)
```
</details>

  * Nutzen Sie den neugewonnen Befehl `describe()`, um sich gleichzeitig die verschiedenen Deskriptivstatistiken für Lebenszufriedenheit (`lz`) ausgeben zu lassen. 
  
  <details><summary>Lösung</summary>
```{r}
describe(pers$lz)
```
</details>

  * `describe()` kann auch genutzt werden, um gleichzeitig Deskriptivstatistiken für verschiedene Variablen zu berechnen. Nutzen Sie diese Funktionalität, um sich gleichzeitg die univariaten Deskriptivstatistiken für die fünf Persönlichkeitsdimensionen ausgeben zu lassen.
  
  <details><summary>Lösung</summary>
```{r}
describe(pers[,-1]) #Spalte für `lz` wird ausgeschlossen
#Alternativ
describe(pers[,c("extra","vertr","gewis","neuro","intel")])
```
</details>    

****
